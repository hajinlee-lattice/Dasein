#!/bin/bash

rm -rf /opt/jetty2/webapps/le-propdata-*.war
rm -rf /opt/jetty2/bin/jetty.sh

adduser yarn
groupadd yarn

mkdir -p /opt/jetty2/logs/propdata
chmod -R 766 /opt/jetty2/logs/propdata
chown -R yarn:yarn /opt/jetty2/logs/propdata

mkdir -p /home/yarn/logs/propdata
chmod -R 766 /home/yarn/logs
chown -R yarn:yarn /home/yarn/logs

mkdir -p /var/log/propdata
chmod -R 766 /var/log/propdata
chown -R yarn:yarn /var/log/propdata

mkdir -p /etc/propdata
chmod -R 766 /etc/propdata
chown -R yarn:yarn /etc/propdata
rm -rf /etc/propdata/propdata.properties

pushd /home/yarn/logs/propdata
for i in *.log.* ; do
    gzip -9 $i ;
done
popd
pushd /var/log/propdata
for i in *.log.* ; do
    gzip -9 $i ;
done
popd