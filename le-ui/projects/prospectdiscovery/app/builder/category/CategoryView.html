<div class="container pd-builder-attributes" ng-controller="AttributesCtrl as attr">
    <div class="row page-header">
        <h4 class="columns six">
            <span ng-if="!attr.ParentValue">{{ attr.AttrKey }}</span> 
            <span ng-if="attr.ParentValue">
                <button 
                    type="button" 
                    class="button icon-button white-button"
                    ui-sref="builder.category({AttrKey: '{{ attr.ParentKey == 'Region' ? 'Locations' : attr.ParentKey }}', ParentKey: '', ParentValue: ''})"
                >
                    <span class="fa fa-arrow-left"></span>
                </button>
                &nbsp;{{ attr.ParentValue }}&nbsp;
            </span>
            <span class="smaller" ng-if="attr.total">({{ attr.total }})</span>
        </h4>
        <span class="columns six">
            <input 
                type="text" 
                class="form-control" 
                ng-model="SearchByName.AttrValue"
                ng-show="ShowSearch" 
            />
            <button type="button" class="button icon-button white-button" ng-click="ShowSearch = !ShowSearch" ng-init="ShowSearch = false;">
                <span class="fa fa-search"></span>
            </button>
            <button type="button" class="button icon-button white-button" ng-click="FilterChecked = !FilterChecked" ng-init="FilterChecked = false;">
                <span class="fa fa-check-square{{ FilterChecked ? '' : '-o' }}"></span>
            </button>
            <button type="button" class="button icon-button white-button" ng-click="SortOrder = (SortOrder == 'AttrValue' ? '-AttrValue' : 'AttrValue')" ng-init="SortOrder = 'AttrValue';">
                <span class="fa fa-sort-alpha-{{ SortOrder == 'AttrValue' ? 'asc' : 'desc' }}"></span>
            </button>
            <a ui-sref="jobs.import.credentials"><button class="button orange-button">Save Attributes</button></a>
        </span>
    </div>

    <div class="row">
        <div class="twelve columns tile-list">
            <div 
                class="list-item
                    {{ attr.SubCategory ? ' has-sub' : '' }}
                    {{ item.selected ? ' selected' : '' }}
                    {{ FilterChecked ? ' filter-checked' : '' }}"
                ng-repeat="(col, item) in attr.list | filter:SearchByName | orderBy: SortOrder"
                ng-click="attr.handleTileClick($event, item)"
            >                
                <div class="tile">
            		<div class="tile-head">
            			<div class="pull-left" ng-click="$event.stopPropagation()">
    	        			<input 
                                type="checkbox" 
                                id="attr-checkbox_{{ row }}_{{ col }}" 
                                class="attr-checkbox custom"
                                ng-model="item.selected"
                                ng-change="attr.handleTileSelect(item)"
                            />
    	        			<label for="attr-checkbox_{{ row }}_{{ col }}" class="attr-label">
                                {{ item.AttrValue | limitTo: attr.truncate_limit }}{{item.AttrValue.length > attr.truncate_limit ? '&hellip;' : ''}}
                                &nbsp;<span ng-if="item.total">( <span class="blue-text">{{ item.total }}</span> )</span>
                            </label>
            			</div>
            			<div class="text-right pull-right">
            				<h3 class="lift">{{ item.lift || "1.0x" }}</h3>
                            <span class="success-text">${{ item.revenue | number:0 }}</span>
            			</div>
            		</div><!-- End .tile-head ; $event.stopPropagation();-->
            		<div class="tile-meta">
            			<div class="stats-container pull-left">
            				<dl class="stats">
            					<dt>Available from Lattice</dt>
            					<dd class="blue-text">{{ item.lattice_companies | number:0 }}</dd>
            				</dl>
            				<dl class="stats">
            					<dt>All in your database</dt>
            					<dd class="in-database">
                                    {{ item.their_companies | number:0 }}&nbsp;
                                <span class="smaller">
                                    ({{ item.mediump | number:1 }}%)
                                </span></dd>
            				</dl>
            				<dl class="stats">
            					<dt>Your customers</dt>
            					<dd class="your-customers">
                                    {{ item.customers | number:0 }}&nbsp;
                                <span class="smaller">
                                    ({{ item.smallp_of_theirs | number:1 }}%)
                                </span></dd>
            				</dl>
            			</div>
                        <div class="circle-container pull-right">
                            <div 
                                class="big-circle saphire-bkg">
                            </div>
                            <div 
                                class="medium-circle gun-metal-bkg"
                                style="width:{{ item.mediump }}%;height:{{ item.mediump }}%;">
                            </div>
                            <div 
                                class="small-circle jet-bkg"
                                style="width:{{ item.smallp }}%;height:{{ item.smallp }}%;">
                            </div>
                        </div>
            		</div><!-- End .tile-meta -->
                </div><!-- End .tile -->
            </div><!-- End .list-item -->

        </div><!-- End .twelve.columns -->
    </div><!-- End .row -->

</div>