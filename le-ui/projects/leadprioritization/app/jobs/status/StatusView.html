<div data-ng-controller="JobsCtrl" class="container">
    <div data-ng-if="succeeded" class="job-success-message">
        <div>{{successMsg}}<a href="javascript:void(0)"><i class="fa fa-times fa-inverse" data-ng-click="closeJobSuccessMessage()"></i></a></div>
        <span>Analytics are now available.</span>
    </div>
    <div data-ng-if="!hideCreationMessage && jobCreationSuccess" class="job-success-message">
        <div>{{jobQueuedMessage}}<a href="javascript:void(0)"><i class="fa fa-times fa-inverse" data-ng-click="closeJobCreationMessage()"></i></a></div>
        <span>It will start running shortly, which will allow you to track the progress</span>
    </div>
    <div data-ng-if="!hideCreationMessage && !jobCreationSuccess" class="job-creation-failed">
        <div>{{jobQueuedMessage}}<a href="javascript:void(0)"><i class="fa fa-times fa-inverse" data-ng-click="closeJobCreationMessage()"></i></a></div>
        <span>Please retry or wait for a fix</span>
    </div>

    <div class="table-header">
        <!--
        <div class="row">
            <div class="twelve columns">
                <h2>Jobs</h2>
            </div>
        </div>
        -->
        <div class="row">
            <div class="four columns meta">
                <!-- <small>Displaying 1-8 of 12</small> -->
            </div>
            <div class="eight columns text-right">
                <input type="text" class="form-control" placeholder="Search for job with type or status" ng-model="query" ng-show="ShowSearch" />
                <a class="button icon-button white-button" ng-click="ShowSearch = !ShowSearch" ng-init="ShowSearch = false;">
                    <span class="fa fa-search"></span>
                </a>
                <a class="button icon-button white-button" ng-click="SortOrder = (SortOrder == 'timestamp' ? '-timestamp' : 'timestamp')" ng-init="SortOrder = '-timestamp';">
                    <span class="fa fa-sort-amount-{{ SortOrder == 'timestamp' ? 'asc' : 'desc' }}"></span>
                </a>
                <!--
                <a ui-sref="home.jobs.import.credentials"><button type="button" class="button blue-button">Import Data</button></a>
                -->
                <a ng-if="state == 'all'" ui-sref="home.models"><button type="button" class="button orange-button">View Models</button></a>
                <button ng-if="state == 'model'" ng-click="handleRescoreClick($event); $event.stopPropagation();" type="button" class="button orange-button">Score Training Data</button>
                <a ng-if="state == 'model'" ui-sref="home.model.scoring"><button type="button" class="button orange-button">Score a File</button></a>
            </div>
        </div><!-- End .row -->
    </div><!-- End .table-header -->

    <div class="row jobs-table">
        <div class="columns twelve panel panel-default">
            <div class="row panel-heading custom-heading">
                <span class="columns two">Timestamp</span>
                <span class="columns three" ng-if="state == 'model'">File Name</span>
                <span class="columns three" ng-if="state != 'model'">Job Type</span>
                <span class="columns one">Status</span>
                <span class="columns three">&nbsp</span>
                <span class="columns three">User</span>
            </div>
            <div class="jobs-table-content">
                <div 
                    data-job-status-row 
                    data-ng-repeat="job in jobs | 
                        filter: query | 
                        orderBy: SortOrder | 
                        startFrom: (current - 1) * pagesize |
                        limitTo: pagesize" 
                    job="job"
                    state="state"
                    statuses="statuses" 
                    expanded="expanded"
                    cancelling="cancelling"
                    class="job-td-row">
                </div>
                <div data-ng-show="showEmptyJobsMessage">
                    There are no jobs to show at the moment
                </div>
            </div>
        </div>
    </div>

    <div class="row" ng-init="pagesize = 8; current = 1" ng-show="max > 1">
        <div class="twelve columns">
            <pd-pagination-controls current="current" max="max = jobs.length / pagesize">
            </pd-pagination-controls>
        </div>
    </div>

</div>