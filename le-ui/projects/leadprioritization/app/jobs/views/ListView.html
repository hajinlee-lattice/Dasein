<div data-ng-controller="JobsListCtrl" class="container">

    <div class="row">
        <div class="twelve columns">
            <div data-ng-if="succeeded" class="job-success-message">
                <div>{{successMsg}}<a href="javascript:void(0)"><i class="fa fa-times fa-inverse" data-ng-click="closeJobSuccessMessage()"></i></a></div>
                <span>Analytics are now available.</span>
            </div>
            <div data-ng-if="!hideCreationMessage && jobCreationSuccess" class="job-success-message">
                <div>{{jobQueuedMessage}}<a href="javascript:void(0)"><i class="fa fa-times fa-inverse" data-ng-click="closeJobCreationMessage()"></i></a></div>
                <span>It will start running shortly, which will allow you to track the progress</span>
            </div>
            <div data-ng-if="!hideCreationMessage && !jobCreationSuccess" class="job-creation-failed">
                <div>{{jobQueuedMessage}}<a href="javascript:void(0)"><i class="fa fa-times fa-inverse" data-ng-click="closeJobCreationMessage()"></i></a></div>
                <span>Please retry or wait for a fix</span>
            </div>
        </div>
    </div>

    <div class="table-header">
        <!--
        <div class="row">
            <div class="twelve columns">
                <h2>Jobs</h2>
            </div>
        </div>
        -->
        <div class="row list-header">
            <div class="pull-left">
                <menu-filter-by config="header.filter"></menu-filter-by>
                <menu-sort-by config="header.sort"></menu-sort-by>
                <search-filter query="query"></search-filter>
            </div>
            <div class="pull-right">
                <!--
                <a ui-sref="home.jobs.import.credentials"><button type="button" class="button blue-button">Import Data</button></a>
                -->
                <a ng-if="state == 'all'" ui-sref="home.models"><button type="button" class="button orange-button">View Models</button></a>
                <button ng-if="state == 'model' && !IsPmml" ng-click="handleRescoreClick($event); $event.stopPropagation();" type="button" class="button orange-button">Score Training Data</button>
                <a ng-if="state == 'model'" ui-sref="home.model.scoring"><button type="button" class="button orange-button">Score a File</button></a>
            </div>
        </div><!-- End .row -->
    </div><!-- End .table-header -->

    <div class="row" ng-init="pagesize = 12; current = 1" ng-show="max > 1">
        <div class="twelve columns">
            <pd-pagination-controls current="current" max="max = (header.filter.filtered | filter: query).length / pagesize">
            </pd-pagination-controls>
        </div>
    </div>
    
    <div class="row jobs-table">
        <div class="columns twelve panel panel-default">
            <div class="row panel-heading custom-heading" ng-init="SortProperty = 'timestamp'">
                <span class="columns two" ng-click="SortProperty = 'timestamp'">Timestamp</span>
                <span class="columns three" ng-click="SortProperty = 'source'" ng-if="state != 'model'">Model Name</span>
                <span class="columns two" ng-click="SortProperty = 'source'" ng-if="state == 'model'">File Name</span>
                <span class="columns two" ng-click="SortProperty = 'jobType'" ng-if="state != 'model'">Job Type</span>
                <span class="columns two" ng-click="SortProperty = 'status'">Status</span>
                <span class="columns two">&nbsp;</span>
                <!-- <span class="columns three" ng-click="SortProperty = 'user'">User</span> -->
            </div>
            <div class="jobs-table-content">
                <div 
                    data-job-status-row 
                    data-ng-repeat="job in header.filter.filtered | 
                        filter: query | 
                        orderBy: header.sort.order + header.sort.property | 
                        startFrom: (current - 1) * pagesize |
                        limitTo: pagesize" 
                    job="job"
                    state="state"
                    statuses="statuses" 
                    expanded="expanded"
                    cancelling="cancelling"
                    class="job-td-row ngAnimate">
                </div>
                <div data-ng-show="(header.filter.filtered | filter: query).length == 0">
                    There are no jobs to show at the moment
                </div>
            </div>
        </div>
    </div>

    <div class="row" ng-init="pagesize = 12; current = 1" ng-show="max > 1">
        <div class="twelve columns">
            <pd-pagination-controls current="current" max="max = (header.filter.filtered | filter: query).length / pagesize">
            </pd-pagination-controls>
        </div>
    </div>

</div>