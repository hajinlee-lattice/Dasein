<div  ng-if="!vm.play" class="loader vertical-center"></div>
<section class="container playbook-dashboard" ng-if="vm.play">
    <div class="container-body">
        <div class="dashboard-column">
            <div class="dashboard-section play">
                <div class="dashboard-section-container">
                    <div class="dashboard-section-header">
                        <h2>{{ vm.play.display_name||'Play Name' }}</h2>
                        Created by {{vm.play.createdBy}} on <time>{{vm.play.timestamp-1000|date:'M/d/yyyy'}}</time>
                    </div>
                    <div class="dashboard-section-content">
                        <p>
                            {{vm.play.description}}
                        </p>
                        <div class="dashboard-section-content-subsection rating_ has-icon">
                            <h4>Rating</h4>
                            <h5>{{vm.play.rating[0].ratingName}}</h5>
                        </div>
                        <div class="dashboard-section-content-subsection segment has-icon">
                            <h4>Segment</h4>
                            <h5>{{vm.play.segment}}</h5>
                            <ul class="controls">
                                <li ng-if="!vm.play.segment"><a ui-sref="home.playbook.dashboard.segment({play_name: vm.play.name})">Add</a></li>
                                <li ng-if="vm.play.segment"><a ui-sref="home.playbook.dashboard.segment({play_name: vm.play.name})">Change</a></li>
                                <li ng-if="vm.play.segment" ng-init="showRemoveSegmentModal = false">
                                    <button class="button white-button" ng-click="showRemoveSegmentModal = !showRemoveSegmentModal">X</button>
                                    <div class="confirmModal" ng-show="showRemoveSegmentModal">
                                        Remove Segment?
                                        <button class="button orange-button" ng-click="vm.removeSegment(vm.play); showRemoveSegmentModal = false">Remove</button>
                                        <button class="button white-button" ng-click="showRemoveSegmentModal = false">Cancel</button>
                                    </div>
                                </li>
                            </ul>
                        </div>
                        <div>
                            <a ui-sref="home.playbook.wizard.settings({play_name: vm.play.name})">temp edit link</a><br />
                            <a href="#" ng-click="showPlayData = !showPlayData">debugging: {{!showPlayData ? "show" : "hide"}} play data</a>
                            <div ng-show="showPlayData">
                                <pre>vm.play: {{vm.play|json}}</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="dashboard-section talking-points">
                <div class="dashboard-section-container">
                    <div class="dashboard-section-header">
                        <h2>Insights</h2>
                    </div>
                    <div class="dashboard-section-content">
                        <div class="dashboard-section-content-subsection talking-points has-icon">
                            <h5>{{vm.talkingPoints.length||'No'}} talking points have been created</h5>
                            <ul class="controls">
                                <li ng-if="!vm.talkingPoints.length"><a ui-sref="home.playbook.dashboard.insights({play_name: vm.play.name})">Create</a></li>
                                <li ng-if="vm.talkingPoints.length"><a ui-sref="home.playbook.dashboard.insights({play_name: vm.play.name})">Edit</a></li>
                            </ul>
                        </div>

                        <div>
                            <a href="#" ng-click="showTalkingPointsData = !showTalkingPointsData">debugging: {{!showTalkingPointsData ? "show" : "hide"}} talking points data</a>
                            <div ng-show="showTalkingPointsData">
                                <pre>vm.talkingPoints: {{vm.talkingPoints|json}}</pre>
                            </div>
                        </div>
                    </div>
                    <div class="dashboard-section-footer">
                        <span ng-if="vm.play.timestamp">Published {{vm.TimestampIntervalUtility.timeAgo(vm.play.timestamp)}}</span>
                    </div>
                </div>
            </div>

        </div>
        <div class="dashboard-column">
            <div class="dashboard-section launch-history">
                <div class="dashboard-section-container">
                    <div class="dashboard-section-header">
                        <h2>Last launch</h2>
                    </div>
                    <div class="dashboard-section-content">
                        <div class="dashboard-section-content-subsection launches">
                            <a href="#" ng-click="showLaunchData = !showLaunchData">debugging: {{!showLaunchData ? "show" : "hide"}} launches data</a>
                            <div ng-show="showLaunchData">
                                <pre>vm.launchHistory: {{vm.launchHistory|json}}</pre>
                            </div>
                        </div>
                        <div class="dashboard-section-content-subsection ratings">
                            <div class="dashboard-subsection-header">
                                <h3>Account ratings</h3>
                            </div>
                            <ul class="ratings-graph" ng-if="vm.ratingsGraph">
                                <li class="_rating" ng-repeat="rating in vm.ratingsGraph.ratings">
                                    <div class="rating-count" ng-show="rating.count">{{rating.count}}</div>
                                    <div class="rating-bar" style="height:{{rating.count/vm.ratingsGraph.total*100}}%;"></div>
                                    <div class="rating-label">{{rating.bucket}}</div>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="dashboard-section-footer">
                        <span ng-if="vm.play.timestamp">Created {{vm.TimestampIntervalUtility.timeAgo(vm.play.timestamp)}}</span>
                        <button class="button blue-button">Launch</button>
                    </div>
                </div>
            </div>

        </div>
    </div>
</section>