

<section class="playbook playbook-launch-history container">
    <div class="card-content" ng-class="{'has-footer': !vm.allPlaysHistory}">

        <select 
            name="category-group" 
            id="categoryGroup" 
            ng-if="vm.allPlaysHistory"
            ng-model="play" 
            ng-change="vm.playSelectChange(play)"
            ng-options="play.displayName for play in vm.defaultPlayLaunchList"
            ng-init="play=vm.defaultPlayLaunchList[0]">
        </select>


        

        <!-- <input type="text" ng-model="searchLaunchedPlays" />
        <ul>
            <li 
                ng-repeat="play in vm.launches.launchSummaries | unique:'playName'">{{play.playDisplayName}}</li>
        </ul> -->



        <ul class="history-metadata">
        	<li>
        		<dl>
        			<dt>Selected Targets</dt>
        			<dd class="blue-text">{{vm.summaryData.selectedTargets | number}}</dd>
        		</dl>
        	</li>
        	<li>
        		<dl>
        			<dt>Suppressed</dt>
        			<dd class="red-text">{{vm.summaryData.suppressed | number}}</dd>
        		</dl>
        	</li>
            <li>
                <dl>
                    <dt>Errors</dt>
                    <dd class="red-text">{{vm.summaryData.errors | number}}</dd>
                </dl>
            </li>
        	<li>
        		<dl>
        			<dt>Launched Recommendations</dt>
        			<dd class="green-text">{{vm.summaryData.recommendationsLaunched | number}}</dd>
        		</dl>
        	</li>
        	<li>
        		<dl>
        			<dt>Contacts within Recommendations</dt>
        			<dd class="green-text">{{vm.summaryData.contactsWithinRecommendations | number}}</dd>
        		</dl>
        	</li>
        </ul>

    	<div class="table-metadata">
    		{{vm.launches.launchSummaries.length}} play launches
    	</div>

    	<table>
    		<thead>
    			<tr>
    				<th>Launch Date</th>
                    <th ng-if="vm.allPlaysHistory">Play Name</th>
    				<th>Selected Targets</th>
    				<th>Suppressed</th>
                    <th>Errors</th>
    				<th>Recommendation <br/>Launched</th>
    				<th>Contacts within <br/>Recommendation</th>
                    <th>Status</th>
    			</tr>
    		</thead>
    		<tbody>
    			<tr ng-repeat="launch in vm.launches.launchSummaries">
    				<td>{{launch.launchTime | date:'hh:mm a on MM/dd/yyyy'}}</td>
                    <td ng-if="vm.allPlaysHistory">{{launch.playDisplayName}}</td>
    				<td class="blue-text">{{launch.stats.selectedTargets | number}}</td>
    				<td class="red-text">{{launch.stats.suppressed | number}}</td>
    				<td class="red-text">{{launch.stats.errors | number}}</td>
                    <td class="green-text">{{launch.stats.recommendationsLaunched | number}}</td>
    				<td class="green-text">{{launch.stats.contactsWithinRecommendations | number}}</td>
                    <td>
                        <span class="fa fa-check" ng-if="launch.launchState === 'Launched'"></span>
                        <span class="fa fa-spinner fa-pulse fw" ng-if="launch.launchState === 'Launching'"></span>
                        <span class="fa fa-exclamation-triangle red-text" ng-if="launch.launchState === 'Failed'"></span>
                        {{launch.launchState}}
                    </td>
    			</tr>
    		</tbody>
    	</table>

        <pd-pagination-controls
            ng-if="vm.showPagination"
            current="vm.current"
            max="vm.launches.launchSummaries.length / vm.pagesize"
            class="pull-right">
        </pd-pagination-controls>

    </div><!-- End .content -->
    <div class="card-footer" ng-if="!vm.allPlaysHistory">
        <button 
            type="button"
            class="button blue-button pull-right"
            ng-if="!vm.launching"
            ng-click="vm.relaunchPlay()">
            Re-Launch
        </button>
        <button 
            type="button"
            class="button blue-button pull-right"
            ng-if="vm.launching"
            disabled>
            <span class="fa fa-spinner fa-pulse fw"></span> Launching...
        </button>
    </div><!-- End .footer -->
</section>


