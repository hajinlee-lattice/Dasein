<div class="container advanced-query-builder">
    <div class="columns twelve">
        <ul class="row controls">
            <li class="buttons pull-right">
                <!-- <a ng-href="/files/latticeinsights/segments/downloadcsv?Authorization={{vm.authToken}}&state={{vm.QueryStore.getUiState().name}}"
                    class="button icon-button white-button" target="_self" download>
                    <i class="fa fa-download"></i>
                </a> -->

                <button class="button icon-button white-button" ng-click="vm.goAttributes()" ng-disabled="vm.saving">Add Attributes</button>
                <button class="button icon-button blue-button"
                        ng-if="!vm.saving" 
                        ng-disabled="vm.checkDisableSave()" 
                        ng-click="vm.saveSegment()">
                    Save Segment
                </button>
                <button ng-if="vm.saving" disabled class="button icon-button blue-button">Saving <i class="fa fa-spinner fa-pulse fw"></i></button>
            </li>
        </ul>

        <div class="row query-algorithm noselect-children">
            <div class="query-algorithm-display">
                <ul class="query-input query-input-root">
                    <li query-input-directive
                        ng-repeat="tree in vm.tree"
                        ng-class="{'input-section-item-box-subtree':tree.logicalRestriction.restrictions}" 
                        class="{{ tree.logicalRestriction.operator ? 'query-input-type-' + tree.logicalRestriction.operator.toLowerCase() : '' }}" 
                        items="vm.items" tree="tree" root="vm" parent="vm[vm.state]">
                    </li>
                </ul>
            </div>

            <button class="query-algorithm-undo button white-button" 
                    ng-click="vm.clickUndo()" 
                    ng-disabled="vm.history.length == 0">
                <i class="fa fa-undo"></i> UNDO
            </button>
        </div>
        
        <div class="row query-helper-text-one">
            <span>
                Build a segment with <strong>accounts</strong> that have:
            </span>
        </div>

        <ul class="query-section query-tree-root">
            <li     ng-class="{'query-section-item-box-subtree':tree.logicalRestriction.operator}" 
                    ng-repeat="tree in vm.tree">
                <query-tree-directive 
                        class="{{ tree.logicalRestriction.operator ? 'query-section-type-' + tree.logicalRestriction.operator.toLowerCase() : '' }}" 
                        items="vm.items" tree="tree" root="vm">
                </query-tree-directive>
            </li>
        </ul>
    </div>
</div>