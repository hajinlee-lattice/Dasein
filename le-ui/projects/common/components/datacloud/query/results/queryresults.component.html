<div class="container query-results">
    <div 
        class="exclude-filter"
        ng-if="
            vm.section === 'dashboard.targets' || vm.section === 'wizard.targets'">
        <label>
            <input 
                type="checkbox" 
                class=""
                ng-model="excludeAccounts"
                ng-click="vm.config.onClick('excludeAccountsWithoutSalesforceId', excludeAccounts)"
                ng-change="vm.excludeNonSalesForceCheckbox(excludeAccounts)" />
            Exclude accounts without SalesForceID (<span class="orange-text">{{ vm.accountsWithoutSfId | number }}</span>)
        </label>
    </div>

    <div class="success-message" ng-if="vm.saved === true">
        <h3>Your segment was saved successfully!</h3>
        <i class="fa fa-times fa-inverse" data-ng-click="vm.hideMessage()"></i>
    </div>

    <ul class="filters">
        <li class="query">
            <div class="ng-search" ng-if="vm.section !== 'dashboard.targets' && vm.section !== 'wizard.targets'">
                <a class="button icon-button white-button" ng-click="vm.clearSearch()">
                    <span 
                        class="fa fa-search" 
                        ng-show="!vm.search.length"></span>
                    <span 
                        class="fa fa-times" 
                        ng-show="vm.search.length"></span>
                </a>
                <input 
                    type="text" 
                    name="SegmentResultSearch" 
                    class="form-control" 
                    placeholder="Search"
                    ng-model="vm.search"
                    ng-model-options='{ debounce: 1000 }'
                    ng-change='vm.submitQuery()'
                    ng-model-options="vm.searchOptions"
                />
            </div>
        </li>
        <li class="buttons" ng-if="vm.section !== 'dashboard.targets' && vm.section !== 'wizard.targets'">
            <div>
                <!-- <a href="/files/latticeinsights/segments/downloadcsv?Authorization={{vm.authToken}}"><button class="button icon-button white-button"><i class="fa fa-download"></i></button></a> -->
                <!-- <button ng-if="!vm.inModel" class="button white-button" ui-sref="home.import.entry">Import Data</button> -->
                <button class="button icon-button white-button" ui-sref="{{ vm.refineQuery() }}" ng-disabled="vm.saving">Refine Query</button>

                <button class="save button blue-button" ng-if="vm.saveSegmentEnabled" ng-click="vm.saveSegment()">Save Segment</button>
                <button class="save button blue-button" ng-if="!vm.saveSegmentEnabled" disabled>Save Segment</button>

            </div>
        </li>
    </ul>

    
    <!--
    The way of rendering these tables needs to be consolidated and refactored in M15.
    - Hadden
    -->

    <table class="list-table" ng-if="vm.page === 'Accounts'">
        <thead ng-class="{'sort-asc': !vm.sortDesc, 'sort-dsc': vm.sortDesc}">
            <tr>
                <th class="sortable" ng-click="sortType = 'LDC_Name'; sortReverse = !sortReverse">
                    Company Name
                    <span ng-show="sortType == 'LDC_Name' && !sortReverse" class="fa fa-caret-down"></span>
                    <span ng-show="sortType == 'LDC_Name' && sortReverse" class="fa fa-caret-up"></span>
                </th>
                <th>Web Address</th>
                <th class="sortable" ng-click="sortType = 'LDC_City'; sortReverse = !sortReverse">
                    City
                    <span ng-show="sortType == 'LDC_City' && !sortReverse" class="fa fa-caret-down"></span>
                    <span ng-show="sortType == 'LDC_City' && sortReverse" class="fa fa-caret-up"></span>
                </th>
                <th class="sortable" ng-click="sortType = 'LDC_State'; sortReverse = !sortReverse">
                    State
                    <span ng-show="sortType == 'LDC_State' && !sortReverse" class="fa fa-caret-down"></span>
                    <span ng-show="sortType == 'LDC_State' && sortReverse" class="fa fa-caret-up"></span>
                </th>
                <th class="sortable" ng-click="sortType = 'LDC_Country'; sortReverse = !sortReverse">
                    Country
                    <span ng-show="sortType == 'LDC_Country' && !sortReverse" class="fa fa-caret-down"></span>
                    <span ng-show="sortType == 'LDC_Country' && sortReverse" class="fa fa-caret-up"></span>
                </th>
                <th>SalesForce ID</th>
            </tr>
        </thead>
        <tbody ng-if="!vm.loading">
            <tr 
                ng-repeat=" account in vm.accounts | 
                            orderBy:sortType:sortReverse | 
                            filter:vm.search">
                <td>{{account.LDC_Name}}</td>
                <td>{{account.LDC_Domain}}</td>
                <td>{{account.LDC_City}}</td>
                <td>{{account.LDC_State}}</td>
                <td>{{account.LDC_Country}}</td>
                <td>
                    <span 
                        class="gray-text"
                        ng-if="account.SalesforceAccountID === null">
                        None
                    </span>
                    <span
                        ng-if="account.SalesforceAccountID != null">
                        {{account.SalesforceAccountID}}
                    </span>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="list-table" ng-if="vm.section === 'dashboard.targets' || vm.section === 'wizard.targets'">
        <thead ng-class="{'sort-asc': !vm.sortDesc, 'sort-dsc': vm.sortDesc}">
            <tr>
                <th class="sortable" ng-click="sortType = 'LDC_Name'; sortReverse = !sortReverse">
                    Company Name
                    <span ng-show="sortType == 'LDC_Name' && !sortReverse" class="fa fa-caret-down"></span>
                    <span ng-show="sortType == 'LDC_Name' && sortReverse" class="fa fa-caret-up"></span>
                </th>
                <th>Web Address</th>
                <th>SalesForce ID</th>
                <th class="sortable" ng-click="sortType = 'ScoreBucket'; sortReverse = !sortReverse">
                    Rating
                    <span ng-show="sortType == 'ScoreBucket' && !sortReverse" class="fa fa-caret-down"></span>
                    <span ng-show="sortType == 'ScoreBucket' && sortReverse" class="fa fa-caret-up"></span>
                </th>
            </tr>
        </thead>
        <tbody ng-if="!vm.loading">
            <tr 
                ng-repeat=" account in vm.accounts | 
                            orderBy:sortType:sortReverse | 
                            filter:vm.search">
                <td>{{account.LDC_Name}}</td>
                <td>{{account.Website}}</td>
                <td>
                    <span 
                        class="gray-text"
                        ng-if="account.SalesforceAccountID === null">
                        None
                    </span>
                    <span
                        ng-if="account.SalesforceAccountID != null">
                        {{account.SalesforceAccountID}}
                    </span>
                </td>
                <td>{{account.ScoreBucket}}</td>
            </tr>
        </tbody>
    </table>
    <table class="list-table" ng-if="vm.page === 'Contacts'">
        <thead ng-class="{'sort-asc': !vm.sortDesc, 'sort-dsc': vm.sortDesc}">
            <tr>
                <th class="sortable" ng-click="sortType = 'ContactName'; sortReverse = !sortReverse">
                    Contact Name
                    <span ng-show="sortType == 'ContactName' && !sortReverse" class="fa fa-caret-down"></span>
                    <span ng-show="sortType == 'ContactName' && sortReverse" class="fa fa-caret-up"></span>
                </th>
                <th class="sortable" ng-click="sortType = 'CompanyName'; sortReverse = !sortReverse">
                    Company Name
                    <span ng-show="sortType == 'CompanyName' && !sortReverse" class="fa fa-caret-down"></span>
                    <span ng-show="sortType == 'CompanyName' && sortReverse" class="fa fa-caret-up"></span>
                </th>
                <th>Email</th>
            </tr>
        </thead>
        <tbody ng-if="!vm.loading">
            <tr 
                ng-repeat=" contact in vm.contacts | 
                            orderBy:sortType:sortReverse | 
                            filter:vm.search">
                <td>{{contact.ContactName}}</td>
                <td>{{contact.CompanyName}}</td>
                <td>{{contact.Email}}</td>
            </tr>
        </tbody>
    </table>





    <div class="loading" ng-if="vm.loading">
         Loading {{vm.page}}...
    </div>
    <div ng-if="vm.accounts.length === 0 || vm.contacts.length === 0">
        <p>No {{vm.page}} Found<p>
    </div>

    <ul class="filters pull-right" ng-if="vm.showAccountPagination">
        <li>
            <pd-pagination-controls
                current="vm.current"
                max="vm.counts.accounts.value / vm.pagesize">
            </pd-pagination-controls>
        </li>
    </ul>
    <ul class="filters pull-right" ng-if="vm.showContactPagination">
        <li>
            <pd-pagination-controls
                current="vm.current"
                max="vm.counts.contacts.value / vm.pagesize">
            </pd-pagination-controls>
        </li>
    </ul>


</div>
