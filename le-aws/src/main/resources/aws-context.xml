<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context.xsd"
       default-lazy-init="true" >

    <context:component-scan base-package="com.latticeengines.aws" />

    <import resource="classpath:aws-credentials-context.xml"/>

    <bean name="s3Client" class="com.amazonaws.services.s3.AmazonS3Client"
          lazy-init="true">
        <constructor-arg index="0" ref="awsCredentials" />
    </bean>

    <bean name="ecrClient" class="com.amazonaws.services.ecr.AmazonECRClient"
          lazy-init="true">
        <constructor-arg index="0" ref="awsCredentials" />
    </bean>

    <bean name="ecsClient" class="com.amazonaws.services.ecs.AmazonECSClient"
          lazy-init="true">
        <constructor-arg index="0" ref="awsCredentials" />
    </bean>

    <bean name="emrClient" class="com.amazonaws.services.elasticmapreduce.AmazonElasticMapReduceAsyncClient"
          lazy-init="true">
        <constructor-arg index="0" ref="awsCredentials" />
    </bean>

    <bean name="kmsClient" class="com.amazonaws.services.kms.AWSKMSClient"
          lazy-init="true">
        <constructor-arg index="0" ref="awsCredentials" />
    </bean>

    <bean id="credentialsProvider" class="com.amazonaws.auth.AWSStaticCredentialsProvider">
        <constructor-arg index="0" ref="awsCredentials" />
    </bean>

    <bean id="sqsClientBuilder" class="com.amazonaws.services.sqs.AmazonSQSClientBuilder" factory-method="standard">
        <property name="region" value="${aws.region}"/>
        <property name="credentials" ref="credentialsProvider"/>
    </bean>

    <bean id="sqsProviderConfiguration" class="com.amazon.sqs.javamessaging.ProviderConfiguration">
        <property name="numberOfMessagesToPrefetch" value="5"/>
    </bean>

    <bean name="sqsConnectionFactory" class="com.amazon.sqs.javamessaging.SQSConnectionFactory" lazy-init="true">
        <constructor-arg ref="sqsProviderConfiguration" />
        <constructor-arg ref="sqsClientBuilder" />
    </bean>

</beans>