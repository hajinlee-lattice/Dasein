#
# $LastChangedBy$
# $LastChangedDate$
# $Rev$
#

import os
from lxml import etree
import re
import liaison
from appsequence import Applicability, AppSequence, StepBase

class LP_020100_Diagnostic(StepBase):
  name = 'LP_020100_Diagnostic'
  description = 'Upgarde to the MissingScore feature'
  version = '$Rev$'
  _scoreDateField = ''
  _scoreField = ''

  def __init__(self, forceApply=False):
    super(LP_020100_Diagnostic, self).__init__(forceApply)

  def getScoreField(self):
    return self._scoreField

  def getScoreDateField(self):
    return self._scoreDateField

  def setScoreField(self, str):
    self._scoreField = str

  def setScoreDateField(self, str):
    self._scoreDateField = str


  def parseScoreField(selfs, str, type):
    if type == 'MKTO':
      s = re.search('<cm scn=\"Score\" tcn=\"(.*?)\"/>', str)
    elif type == 'ELQ':
      s = re.search('<cm scn=\"C_Lattice_Predictive_Score1\" tcn=\"(.*?)\"/>', str)
    else:
      s = re.search('<cm scn=\"C_Lattice_Predictive_Score1\" tcn=\"(.*?)\"/>', str)

    if not s:
      print "Error get the Score Field failed"
      return None
    return s.group(1)

  def parseScoreDateField(self, str, type):
    if type == 'MKTO':
      s = re.search('<cm scn=\"Score_Date_Time\" tcn=\"(.*?)\"/>', str)
    elif type == 'ELQ':
      s = re.search('<cm scn=\"C_Lattice_LastScoreDate1\" tcn=\"(.*?)\"/>', str)
    else:
      s = re.search('<cm scn=\"C_Lattice_LastScoreDate1\" tcn=\"(.*?)\"/>', str)

    if not s:
      print "Error get the Score Field failed"
      return None
    return s.group(1)

  def getApplicability(self, appseq):
    lgm = appseq.getLoadGroupMgr()
    type = appseq.getText('template_type')

    if not lgm.hasLoadGroup('PushToLeadDestination_Step1'):
      return Applicability.cannotApplyPass

    ptld_lbo_xml = lgm.getLoadGroupFunctionality('PushToLeadDestination_Step1', 'lssbardouts')

    self.setScoreField(self.parseScoreField(ptld_lbo_xml, type))
    self.setScoreDateField(self.parseScoreDateField(ptld_lbo_xml, type))

    if not self.getScoreField() or not self.getScoreDateField():
      return Applicability.cannotApplyPass

    return Applicability.canApply

  def apply(self, appseq):
    lgm = appseq.getLoadGroupMgr()
    type = appseq.getText('template_type')

    if type == 'MKTO':
      step1_xml = '''
      <group name="Diagnostic_LoadLeads" alias="Diagnostic_LoadLeads" w="Workspace" type="1" scheduleType="0" allowUserChangeScheduleType="False" visibleForEndUser="True" threshold="10000" launchExpiredDays="7" createdBy="richard.liu@lattice-engines.com" path="Diagnostic" autoGenerated="False" validationValidMinutes="120" autoClearOnFailure="False" mergeRulesSaved="True" ng="False">
        <schemas />
        <visiDBConfigurationWithMacros />
        <targetQueries />
        <targetQuerySequences />
        <rdss>
          <rds n="MKTO_ActivityRecord_Validation" w="Workspace" sn="MKTO_ActivityRecord_Validation" cn="Marketo_DataProvider" u="False" ss="" tn="ActivityRecord" nmo="1" f="@recordCOUNT(100000) AND&#xD;&#xA;activityDateTime &gt; #Diagnostic_LowerLimitTime AND activityDateTime &lt; #Diagnostic_UpperLimitTime AND&#xD;&#xA;activityType in ('New Lead','Click Link','Visit Webpage','Interesting Moment','Open Email','Email Bounced Soft','Fill Out Form','Unsubscribe Email','Click Email')" ad="False" em="False" td="False" ic="" dd="" l="1000" tw="False" sr="50000" htw="24" mtw="60" emt="False" acd="False" mgf="False" eo="2" emd="False" eo_sftp="1">
            <ts>
              <t n="Diagnostic_LowerLimitTime" t="1" qn="Q_Diagnostic_ExtractLeadsRange" cn="Diagnostic_LowerLimitTime" m="0">
                <schemas />
                <specs />
              </t>
              <t n="Diagnostic_UpperLimitTime" t="1" qn="Q_Diagnostic_ExtractLeadsRange" cn="Diagnostic_UpperLimitTime" m="0">
                <schemas />
                <specs />
              </t>
            </ts>
            <mcs>
              <mc cn="activityDateTime" />
              <mc cn="activityType" />
              <mc cn="campaign" />
              <mc cn="foreignSysId" />
              <mc cn="foreignSysOrgId" />
              <mc cn="id" />
              <mc cn="mktgAssetName" />
              <mc cn="mktPersonId" />
              <mc cn="orgName" />
              <mc cn="personName" />
            </mcs>
          </rds>
          <rds n="MKTO_LeadRecord_Validation" w="Workspace" sn="MKTO_LeadRecord_Validation" cn="Marketo_DataProvider" u="False" ss="" tn="LeadRecord" nmo="1" f="id in #IDs" ad="False" em="False" td="False" ic="" dd="" l="1000" tw="False" sr="50000" htw="24" mtw="60" emt="False" acd="False" mgf="False" eo="2" emd="False" eo_sftp="1">
            <ts>
              <t n="IDs" t="2" qn="Q_Diagnostic_GetLeadRecordID" cn="MKTO_LeadRecord_ID" m="100">
                <schemas />
                <specs />
              </t>
            </ts>
            <mcs>
              <mc cn="Id" />
              <mc cn="latticeforleads__Last_Score_Date__c" />
              <mc cn="latticeforleads__Score__c" />
            </mcs>
          </rds>
        </rdss>
        <validationExtracts />
        <ces />
        <extractQueries />
        <extractQuerySequences />
        <leafExtracts />
        <launchExtracts />
        <jobs />
        <pdmatches />
        <leadscroings />
        <lssbardins />
        <lssbardouts />
        <lds />
        <ecs />
        <gCs />
      </group>
      '''
      step1_xml = step1_xml.replace('latticeforleads__Score__c', self.getScoreField())
      step1_xml = step1_xml.replace('latticeforleads__Last_Score_Date__c', self.getScoreDateField())

    elif type == 'ELQ':
      step1_xml = '''
          <group name="Diagnostic_LoadLeads" alias="Diagnostic_LoadLeads" w="Workspace" type="1" scheduleType="0" allowUserChangeScheduleType="False" visibleForEndUser="True" threshold="10000" launchExpiredDays="7" createdBy="richard.liu@lattice-engines.com" path="Diagnostic" autoGenerated="False" validationValidMinutes="120" autoClearOnFailure="False" mergeRulesSaved="True" ng="False">
      <schemas />
      <visiDBConfigurationWithMacros />
      <targetQueries />
      <targetQuerySequences />
      <rdss>
        <rds n="ELQ_Contact_Validation" w="Workspace" sn="ELQ_Contact_Validation" cn="Eloqua_Bulk_DataProvider" u="False" ss="" tn="Contact" nmo="1" f="@recordCOUNT(10000) AND&#xD;&#xA;((C_DateModified &gt; #Diagnostic_LowerLimitTime AND C_DateModified &lt; #Diagnostic_UpperLimitTime AND C_Lattice_LastScoreDate1 &lt; #Diagnostic_RescoreThreshold) OR ( C_DateModified &gt; #Diagnostic_LowerLimitTime AND C_DateModified &lt; #Diagnostic_UpperLimitTime AND C_Lattice_Predictive_Score1 = 0 ))" ad="False" em="False" td="False" ic="" dd="" l="1000" tw="False" sr="50000" htw="24" mtw="60" emt="False" acd="False" mgf="False" eo="2" emd="False" eo_sftp="1">
          <ts>
            <t n="Diagnostic_LowerLimitTime" t="1" qn="Q_Diagnostic_ExtractLeadsRange" cn="Diagnostic_LowerLimitTime" m="0">
              <schemas />
              <specs />
            </t>
            <t n="Diagnostic_UpperLimitTime" t="1" qn="Q_Diagnostic_ExtractLeadsRange" cn="Diagnostic_UpperLimitTime" m="0">
              <schemas />
              <specs />
            </t>
            <t n="Diagnostic_RescoreThreshold" t="1" qn="Q_Diagnostic_ExtractLeadsRange" cn="Diagnostic_RescoreThreshold" m="0">
              <schemas />
              <specs />
            </t>
          </ts>
          <mcs>
            <mc cn="C_DateCreated" />
            <mc cn="C_DateModified" />
            <mc cn="C_Lattice_LastScoreDate1" />
            <mc cn="C_Lattice_Predictive_Score1" />
            <mc cn="ContactID" />
          </mcs>
        </rds>
      </rdss>
      <validationExtracts />
      <ces />
      <extractQueries />
      <extractQuerySequences />
      <leafExtracts />
      <launchExtracts />
      <jobs />
      <pdmatches />
      <leadscroings />
      <lssbardins />
      <lssbardouts />
      <lds />
      <ecs />
      <gCs />
    </group>
    '''
      step1_xml = step1_xml.replace('C_Lattice_Predictive_Score1', self.getScoreField())
      step1_xml = step1_xml.replace('C_Lattice_LastScoreDate1', self.getScoreDateField())

    else :
      step1_xml = '''
      <group name="Diagnostic_LoadLeads" alias="Diagnostic_LoadLeads" w="Workspace" type="1" scheduleType="0" allowUserChangeScheduleType="False" visibleForEndUser="True" threshold="10000" launchExpiredDays="7" createdBy="richard.liu@lattice-engines.com" path="Diagnostic" autoGenerated="False" validationValidMinutes="120" autoClearOnFailure="False" mergeRulesSaved="True" ng="False">
        <schemas />
        <visiDBConfigurationWithMacros />
        <targetQueries />
        <targetQuerySequences />
        <rdss>
          <rds n="SFDC_Contact_Validation" w="Workspace" sn="SFDC_Contact_Validation" cn="SFDC_DataProvider" u="False" ss="" tn="Contact" nmo="1" f="LastModifiedDate&gt; #Diagnostic_LowerLimitTime_Contact AND LastModifiedDate&lt; #Diagnostic_UpperLimitTime_Contact AND ( latticeforleads__Last_Score_Date__c &lt; #Diagnostic_RescoreThreshold_Contact OR latticeforleads__Last_Score_Date__c = null ) AND @RecordCOUNT(10000)" ad="False" em="False" td="False" ic="" dd="" l="1000" tw="False" sr="50000" htw="24" mtw="60" emt="False" acd="False" mgf="False" eo="2" emd="False" eo_sftp="2">
            <ts>
              <t n="Diagnostic_LowerLimitTime_Contact" t="1" qn="Q_Diagnostic_ExtractLeadsRange" cn="Diagnostic_LowerLimitTime_Contact" m="0">
                <schemas />
                <specs />
              </t>
              <t n="Diagnostic_UpperLimitTime_Contact" t="1" qn="Q_Diagnostic_ExtractLeadsRange" cn="Diagnostic_UpperLimitTime_Contact" m="0">
                <schemas />
                <specs />
              </t>
              <t n="Diagnostic_RescoreThreshold_Contact" t="1" qn="Q_Diagnostic_ExtractLeadsRange" cn="Diagnostic_RescoreThreshold_Contact" m="0">
                <schemas />
                <specs />
              </t>
            </ts>
            <mcs>
              <mc cn="CreatedDate" />
              <mc cn="Id" />
              <mc cn="LastModifiedDate" />
              <mc cn="latticeforleads__Last_Score_Date__c" />
              <mc cn="latticeforleads__Score__c" />
            </mcs>
          </rds>
          <rds n="SFDC_Lead_Validation" w="Workspace" sn="SFDC_Lead_Validation" cn="SFDC_DataProvider" u="False" ss="" tn="Lead" nmo="1" f="LastModifiedDate&gt; #Diagnostic_LowerLimitTime_Lead AND LastModifiedDate&lt; #Diagnostic_UpperLimitTime_Lead AND ( latticeforleads__Last_Score_Date__c &lt; #Diagnostic_RescoreThreshold_Lead OR latticeforleads__Last_Score_Date__c  = null ) AND @RecordCOUNT(10000)" ad="False" em="False" td="False" ic="" dd="" l="1000" tw="False" sr="50000" htw="24" mtw="60" emt="False" acd="False" mgf="False" eo="2" emd="False" eo_sftp="2">
            <ts>
              <t n="Diagnostic_LowerLimitTime_Lead" t="1" qn="Q_Diagnostic_ExtractLeadsRange" cn="Diagnostic_LowerLimitTime_Lead" m="0">
                <schemas />
                <specs />
              </t>
              <t n="Diagnostic_UpperLimitTime_Lead" t="1" qn="Q_Diagnostic_ExtractLeadsRange" cn="Diagnostic_UpperLimitTime_Lead" m="0">
                <schemas />
                <specs />
              </t>
              <t n="Diagnostic_RescoreThreshold_Lead" t="1" qn="Q_Diagnostic_ExtractLeadsRange" cn="Diagnostic_RescoreThreshold_Lead" m="0">
                <schemas />
                <specs />
              </t>
            </ts>
            <mcs>
              <mc cn="CreatedDate" />
              <mc cn="Id" />
              <mc cn="LastModifiedDate" />
              <mc cn="latticeforleads__Last_Score_Date__c" />
              <mc cn="latticeforleads__Score__c" />
            </mcs>
          </rds>
        </rdss>
        <validationExtracts />
        <ces />
        <extractQueries />
        <extractQuerySequences />
        <leafExtracts />
        <launchExtracts />
        <jobs />
        <pdmatches />
        <leadscroings />
        <lssbardins />
        <lssbardouts />
        <lds />
        <ecs />
        <gCs />
      </group>
      '''

      step1_xml = step1_xml.replace('latticeforleads__Score__c', self.getScoreField())
      step1_xml = step1_xml.replace('latticeforleads__Last_Score_Date__c', self.getScoreDateField())

    lgm.setLoadGroup(step1_xml )

    if type == 'MKTO':
      step2_xml ='''
      <group name="Diagnostic_PushToDestination" alias="Diagnostic_PushToDestination" w="Workspace" type="1" scheduleType="0" allowUserChangeScheduleType="False" visibleForEndUser="True" threshold="10000" launchExpiredDays="7" createdBy="richard.liu@lattice-engines.com" path="Diagnostic" autoGenerated="False" validationValidMinutes="120" autoClearOnFailure="False" mergeRulesSaved="True" ng="False">
        <schemas />
        <visiDBConfigurationWithMacros />
        <targetQueries>
          <targetQuery w="Workspace" t="2" name="Q_Diagnostic_MissingDownloadedLeads" alias="Q_Diagnostic_MissingDownloadedLeads" isc="True" threshold="10000" fsTableName="UnscoredLeads" sourceType="1" jobType="20" ignoreOptionsValue="0" exportToDestDirectly="True" exportRule="4" fileExt="bcp" rowTerminator="\\0\\r" columnTerminator="\\0" edts="False" destType="SQL" destDataProvider="SQL_LeadValidation_DataProvider" cto="0">
            <schemas />
            <specs />
            <fsColumnMappings>
              <fsColumnMapping queryColumnName="LeadScore" fsColumnName="LeadScore" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="LastScoreDate" fsColumnName="LastScoreDate" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="ModifiedDate" fsColumnName="ModifiedDate" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="CreatedDate" fsColumnName="CreatedDate" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="IsMissingDownloadedLeads" fsColumnName="IsMissingDownloadedLeads" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="LeadID" fsColumnName="LeadID" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
            </fsColumnMappings>
            <excludeColumns />
            <validationQueries />
            <constantRows />
            <kcs>
              <kc n="LeadID" />
            </kcs>
            <fut dn="" d="" n="" iet="False" iets="False" t="1" />
          </targetQuery>
          <targetQuery w="Workspace" t="2" name="Q_Diagnostic_DownloadedUnscoredLeads" alias="Q_Diagnostic_DownloadedUnscoredLeads" isc="True" threshold="10000" fsTableName="UnscoredLeads" sourceType="1" jobType="20" ignoreOptionsValue="0" exportToDestDirectly="True" exportRule="4" fileExt="bcp" rowTerminator="\\0\\r" columnTerminator="\\0" edts="False" destType="SQL" destDataProvider="SQL_LeadValidation_DataProvider" cto="0">
            <schemas />
            <specs />
            <fsColumnMappings>
              <fsColumnMapping queryColumnName="LeadScore" fsColumnName="LeadScore" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="LastScoreDate" fsColumnName="LastScoreDate" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="ModifiedDate" fsColumnName="ModifiedDate" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="CreatedDate" fsColumnName="CreatedDate" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="IsFailedScoringLeads" fsColumnName="IsFailedScoringLeads" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="IsDownloadedButMissScoringLeads" fsColumnName="IsDownloadedButMissScoringLeads" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="LeadID" fsColumnName="LeadID" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
            </fsColumnMappings>
            <excludeColumns />
            <validationQueries />
            <constantRows />
            <kcs>
              <kc n="LeadID" />
            </kcs>
            <fut dn="" d="" n="" iet="False" iets="False" t="1" />
          </targetQuery>
        </targetQueries>
        <targetQuerySequences>
          <sequence w="Workspace" queryName="Q_Diagnostic_MissingDownloadedLeads" sequence="1" />
          <sequence w="Workspace" queryName="Q_Diagnostic_DownloadedUnscoredLeads" sequence="2" />
        </targetQuerySequences>
        <rdss />
        <validationExtracts />
        <ces />
        <extractQueries />
        <extractQuerySequences />
        <leafExtracts />
        <launchExtracts />
        <jobs />
        <pdmatches />
        <leadscroings />
        <lssbardins />
        <lssbardouts />
        <lds />
        <ecs />
        <gCs />
      </group>
      '''
    elif type == 'ELQ':
      step2_xml = '''
      <group name="Diagnostic_PushToDestination" alias="Diagnostic_PushToDestination" w="Workspace" type="1" scheduleType="0" allowUserChangeScheduleType="False" visibleForEndUser="True" threshold="10000" launchExpiredDays="7" createdBy="richard.liu@lattice-engines.com" path="Diagnostic" autoGenerated="False" validationValidMinutes="120" autoClearOnFailure="False" mergeRulesSaved="True" ng="False">
        <schemas />
        <visiDBConfigurationWithMacros />
        <targetQueries>
          <targetQuery w="Workspace" t="2" name="Q_Diagnostic_MissingDownloadedLeads" alias="Q_Diagnostic_MissingDownloadedLeads" isc="True" threshold="10000" fsTableName="UnscoredLeads" sourceType="1" jobType="20" ignoreOptionsValue="0" exportToDestDirectly="True" exportRule="4" fileExt="bcp" rowTerminator="\\0\\r" columnTerminator="\\0" edts="False" destType="SQL" destDataProvider="SQL_LeadValidation_DataProvider" cto="0">
            <schemas />
            <specs />
            <fsColumnMappings>
              <fsColumnMapping queryColumnName="LeadScore" fsColumnName="LeadScore" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="LastScoreDate" fsColumnName="LastScoreDate" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="ModifiedDate" fsColumnName="ModifiedDate" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="CreatedDate" fsColumnName="CreatedDate" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="IsMissingDownloadedLeads" fsColumnName="IsMissingDownloadedLeads" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="LeadID" fsColumnName="LeadID" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
            </fsColumnMappings>
            <excludeColumns />
            <validationQueries />
            <constantRows />
            <kcs>
              <kc n="LeadID" />
            </kcs>
            <fut dn="" d="" n="" iet="False" iets="False" t="1" />
          </targetQuery>
          <targetQuery w="Workspace" t="2" name="Q_Diagnostic_DownloadedUnscoredLeads" alias="Q_Diagnostic_DownloadedUnscoredLeads" isc="True" threshold="10000" fsTableName="UnscoredLeads" sourceType="1" jobType="20" ignoreOptionsValue="0" exportToDestDirectly="True" exportRule="4" fileExt="bcp" rowTerminator="\\0\\r" columnTerminator="\\0" edts="False" destType="SQL" destDataProvider="SQL_LeadValidation_DataProvider" cto="0">
            <schemas />
            <specs />
            <fsColumnMappings>
              <fsColumnMapping queryColumnName="LeadScore" fsColumnName="LeadScore" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="LastScoreDate" fsColumnName="LastScoreDate" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="ModifiedDate" fsColumnName="ModifiedDate" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="CreatedDate" fsColumnName="CreatedDate" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="IsFailedScoringLeads" fsColumnName="IsFailedScoringLeads" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="IsDownloadedButMissScoringLeads" fsColumnName="IsDownloadedButMissScoringLeads" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
              <fsColumnMapping queryColumnName="LeadID" fsColumnName="LeadID" formatter="" type="0" ignoreType="0" ignoreOptions="0" formatColumnName="False" charsToFormat="" />
            </fsColumnMappings>
            <excludeColumns />
            <validationQueries />
            <constantRows />
            <kcs>
              <kc n="LeadID" />
            </kcs>
            <fut dn="" d="" n="" iet="False" iets="False" t="1" />
          </targetQuery>
        </targetQueries>
        <targetQuerySequences>
          <sequence w="Workspace" queryName="Q_Diagnostic_MissingDownloadedLeads" sequence="1" />
          <sequence w="Workspace" queryName="Q_Diagnostic_DownloadedUnscoredLeads" sequence="2" />
        </targetQuerySequences>
        <rdss />
        <validationExtracts />
        <ces />
        <extractQueries />
        <extractQuerySequences />
        <leafExtracts />
        <launchExtracts />
        <jobs />
        <pdmatches />
        <leadscroings />
        <lssbardins />
        <lssbardouts />
        <lds />
        <ecs />
        <gCs />
      </group>
      '''
    elif type == 'SFDC':
      step2_xml = '''
      <group name="Diagnostic_PushToDestination" alias="Diagnostic_PushToDestination" w="Workspace" type="1" scheduleType="0" allowUserChangeScheduleType="False" visibleForEndUser="True" threshold="10000" launchExpiredDays="7" createdBy="richard.liu@lattice-engines.com" path="Diagnostic" autoGenerated="False" validationValidMinutes="120" autoClearOnFailure="False" mergeRulesSaved="True" ng="False">
        <schemas />
        <visiDBConfigurationWithMacros />
        <targetQueries>
          <targetQuery w="Workspace" t="2" name="Q_Diagnostic_MissingDownloadedLeads" alias="Q_Diagnostic_MissingDownloadedLeads" isc="True" threshold="10000" fsTableName="UnscoredLeads" sourceType="1" jobType="20" ignoreOptionsValue="0" exportToDestDirectly="True" exportRule="4" fileExt="bcp" rowTerminator="\\0\\r" columnTerminator="\\0" edts="False" destType="SQL" destDataProvider="SQL_LeadValidation_DataProvider" cto="0">
            <schemas />
            <specs />
            <fsColumnMappings />
            <excludeColumns />
            <validationQueries />
            <constantRows />
            <kcs>
              <kc n="LeadID" />
              <kc n="TenantName" />
            </kcs>
            <fut dn="" d="" n="" iet="False" iets="False" t="1" />
          </targetQuery>
          <targetQuery w="Workspace" t="2" name="Q_Diagnostic_DownloadedUnscoredLeads" alias="Q_Diagnostic_DownloadedUnscoredLeads" isc="True" threshold="10000" fsTableName="UnscoredLeads" sourceType="1" jobType="20" ignoreOptionsValue="0" exportToDestDirectly="True" exportRule="4" fileExt="bcp" rowTerminator="\\0\\r" columnTerminator="\\0" edts="False" destType="SQL" destDataProvider="SQL_LeadValidation_DataProvider" cto="0">
            <schemas />
            <specs />
            <fsColumnMappings />
            <excludeColumns />
            <validationQueries />
            <constantRows />
            <kcs>
              <kc n="LeadID" />
              <kc n="TenantName" />
            </kcs>
            <fut dn="" d="" n="" iet="False" iets="False" t="1" />
          </targetQuery>
        </targetQueries>
        <targetQuerySequences>
          <sequence w="Workspace" queryName="Q_Diagnostic_MissingDownloadedLeads" sequence="1" />
          <sequence w="Workspace" queryName="Q_Diagnostic_DownloadedUnscoredLeads" sequence="2" />
        </targetQuerySequences>
        <rdss />
        <validationExtracts />
        <ces />
        <extractQueries />
        <extractQuerySequences />
        <leafExtracts />
        <launchExtracts />
        <jobs />
        <pdmatches />
        <leadscroings />
        <lssbardins />
        <lssbardouts />
        <lds />
        <ecs />
        <gCs />
      </group>
      '''
    lgm.setLoadGroup(step2_xml)

    # Enable Diagnostic in the FinalDailyJob
    if type == 'SFDC':
      step3_xml = '''
      <group name="AdditionalDailyTasks" alias="AdditionalDailyTasks" w="Workspace" type="1" scheduleType="0" allowUserChangeScheduleType="False" visibleForEndUser="True" threshold="10000" launchExpiredDays="7" createdBy="lyan@lattice-engines.com" autoGenerated="False" validationValidMinutes="120" autoClearOnFailure="True" mergeRulesSaved="True" ng="True">
        <schemas />
        <visiDBConfigurationWithMacros />
        <targetQueries />
        <targetQuerySequences />
        <rdss />
        <validationExtracts />
        <ces />
        <extractQueries />
        <extractQuerySequences />
        <leafExtracts />
        <launchExtracts />
        <jobs />
        <pdmatches />
        <leadscroings />
        <lssbardins />
        <lssbardouts />
        <lds />
        <ecs />
        <gCs />
      </group>
      '''
      lgm.setLoadGroup(step3_xml)

      step4_xml = '''
      <group name="FinalDailyTasks" alias="FinalDailyTasks" w="Workspace" type="1" scheduleType="0" allowUserChangeScheduleType="False" visibleForEndUser="True" threshold="10000" launchExpiredDays="7" createdBy="lyan@lattice-engines.com" autoGenerated="False" validationValidMinutes="120" autoClearOnFailure="True" mergeRulesSaved="True" ng="True">
        <schemas />
        <ngs>
          <ng n="Diagnostic_LoadLeads" />
          <ng n="Diagnostic_PushToDestination" />
        </ngs>
        <visiDBConfigurationWithMacros />
        <targetQueries />
        <targetQuerySequences />
        <rdss />
        <validationExtracts />
        <ces />
        <extractQueries />
        <extractQuerySequences />
        <leafExtracts />
        <launchExtracts />
        <jobs />
        <pdmatches />
        <leadscroings />
        <lssbardins />
        <lssbardouts />
        <lds />
        <ecs />
        <gCs />
      </group>
      '''
      lgm.setLoadGroup(step4_xml)

    else:
      fdt_ngs_xml = lgm.getLoadGroupFunctionality( 'FinalDailyTasks', 'ngs' )
      fdt_ngs = etree.fromstring( fdt_ngs_xml )
      ng = etree.Element("ng", n="Diagnostic_LoadLeads")
      fdt_ngs.append(ng)
      ng = etree.Element("ng", n="Diagnostic_PushToDestination")
      fdt_ngs.append(ng)
      lgm.setLoadGroupFunctionality( 'FinalDailyTasks', etree.tostring(fdt_ngs) )

    # Add to the consolidation
    ce_ces_xml = lgm.getLoadGroupFunctionality('ConsolidateExtracts', 'ces')
    ce_ces = etree.fromstring(ce_ces_xml)
    ce_ws = ce_ces.find('ws')
    if type == 'ELQ':
      ce_ce_xml = '''
      <ws>
          <ce itn="ELQ_Contact_Diagnostic_Import" etr="1" sei="0" />
          <ce itn="Info_PublicDomain_Import" etr="1" sei="0" />
          <ce itn="ELQ_Contact_Validation_Import" etr="1" sei="0" />
          <ce itn="LeadCache_Contact_Import" etr="3" sei="0" />
          <ce itn="LeadCache_Lead_Import" etr="3" sei="0" />
          <ce itn="Timestamp_DownloadedSFDC_Contacts_Import" etr="1" sei="0" />
          <ce itn="Timestamp_DownloadedSFDC_Leads_Import" etr="1" sei="0" />
          <ce itn="Timestamp_LoadScoredLeads_Import" etr="1" sei="0" />
          <ce itn="Timestamp_PushToDante_Stage_Import" etr="1" sei="0" />
      </ws>
      '''
    elif type == 'MKTO':
      ce_ce_xml = '''
      <ws>
          <ce itn="MKTO_ActivityRecord_Diagnostic_Import" etr="1" sei="0" />
          <ce itn="MKTO_LeadRecord_Diagnostic_Import" etr="1" sei="0" />
          <ce itn="MKTO_LeadRecord_Validation_Import" etr="1" sei="0" />
          <ce itn="MKTO_ActivityRecord_Validation_Import" etr="1" sei="0" />
          <ce itn="LeadCache_Contact_Import" etr="3" sei="0" />
          <ce itn="LeadCache_Lead_Import" etr="3" sei="0" />
          <ce itn="Timestamp_DownloadedSFDC_Contacts_Import" etr="1" sei="0" />
          <ce itn="Timestamp_DownloadedSFDC_Leads_Import" etr="1" sei="0" />
          <ce itn="Timestamp_LoadScoredLeads_Import" etr="1" sei="0" />
          <ce itn="Timestamp_PushToDante_Stage_Import" etr="1" sei="0" />
      </ws>
      '''
    else:
      ce_ce_xml = '''
      <ws>
            <ce itn="LeadCache_Contact_Import" etr="3" sei="0" />
            <ce itn="LeadCache_Lead_Import" etr="3" sei="0" />
            <ce itn="Timestamp_LoadScoredLeads_Import" etr="1" sei="0" />
            <ce itn="Timestamp_PushToDante_Stage_Import" etr="1" sei="0" />
            <ce itn="SFDC_Contact_Validation_Import" etr="1" sei="0" />
            <ce itn="SFDC_Lead_Validation_Import" etr="1" sei="0" />
      </ws>
      '''
    ce = etree.fromstring(ce_ce_xml)
    ce_list = list(ce.iter('ce'))
    for ce in ce_list:
      ce_ws.append(ce)
    lgm.setLoadGroupFunctionality( 'ConsolidateExtracts', etree.tostring(ce_ces) )

    # Begin visiDB part

    conn_mgr = appseq.getConnectionMgr()
    tenantName = conn_mgr.getTenantName()

    tenantNameSpec = '''
      SpecLatticeNamedElement(
        SpecLatticeFunction(
          LatticeFunctionExpressionConstantScalar(
            "UnknownTenant",
            DataTypeVarChar(UnknownLength)
          ),
          DataTypeUnknown,
          SpecFunctionTypeMetric,
          SpecFunctionSourceTypeCalculation,
          SpecDefaultValueNull,
          SpecDescription("")
        ),
        ContainerElementName("Const_TenantName")
      ),
    '''

    tenantNameSpec = tenantNameSpec.replace('UnknownTenant', tenantName)
    tenantNameSpec = tenantNameSpec.replace('UnknownLength',str(len(tenantName)))

    if type == 'MKTO':
      specs = 'SpecLatticeNamedElements(('
      specs += tenantNameSpec
      specs += 'SpecLatticeNamedElement(SpecLatticeSourceTable(SpecLatticeSourceTableColumnSet((' \
               'SpecLatticeSourceTableColumn(LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("MKTO_ActivityRecord_Validation")), ' \
               'ContainerElementName("id"))), DataTypeLong, SpecFieldTypeAttribute(LatticeAddressAtomicIdentifier(' \
               'ContainerElementName("MKTO_ActivityRecord_ID")), SpecConstructiveIsConstructive, ' \
               'FunctionAggregationOperator("Sum")), SpecColumnContentContainerElementName(ContainerElementName(' \
               '"id")), SpecEndpointTypeNone, SpecDefaultValueNull, SpecKeyAggregation(' \
               'SpecColumnAggregationRuleFunction("Sum")), SpecEquivalenceAggregation(' \
               'SpecColumnAggregationRuleFunction("Sum"))), SpecLatticeSourceTableColumn(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(ContainerElementName(' \
               '"MKTO_ActivityRecord_Validation")), ContainerElementName("activityDateTime"))), DataTypeDateTime, ' \
               'SpecFieldTypeMetric(FunctionAggregationOperator("Max")), SpecColumnContentContainerElementName(' \
               'ContainerElementName("activityDateTime")), SpecEndpointTypeNone, SpecDefaultValue(""), ' \
               'SpecKeyAggregation(SpecColumnAggregationRuleFunction("Max")), SpecEquivalenceAggregation(' \
               'SpecColumnAggregationRuleFunction("Max"))), SpecLatticeSourceTableColumn(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(ContainerElementName(' \
               '"MKTO_ActivityRecord_Validation")), ContainerElementName("activityType"))), DataTypeNVarChar(510), ' \
               'SpecFieldTypeMetric(FunctionAggregationOperator("Combine")), SpecColumnContentContainerElementName(' \
               'ContainerElementName("activityType")), SpecEndpointTypeNone, SpecDefaultValueNull, ' \
               'SpecKeyAggregation(SpecColumnAggregationRuleFunction("Combine")), SpecEquivalenceAggregation(' \
               'SpecColumnAggregationRuleFunction("Combine"))), SpecLatticeSourceTableColumn(' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("MKTO_ActivityRecord_Validation")), ContainerElementName("mktgAssetName"))), ' \
               'DataTypeNVarChar(1022), SpecFieldTypeAttribute(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"mktgAssetName")), SpecConstructiveIsConstructive, FunctionAggregationOperator("Combine")), ' \
               'SpecColumnContentContainerElementName(ContainerElementName("mktgAssetName")), SpecEndpointTypeNone, ' \
               'SpecDefaultValueNullNoRTrim, SpecKeyAggregation(SpecColumnAggregationRuleFunction("Combine")), ' \
               'SpecEquivalenceAggregation(SpecColumnAggregationRuleFunction("Combine"))), ' \
               'SpecLatticeSourceTableColumn(LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("MKTO_ActivityRecord_Validation")), ' \
               'ContainerElementName("campaign"))), DataTypeNVarChar(1022), SpecFieldTypeMetric(' \
               'FunctionAggregationOperator("Combine")), SpecColumnContentContainerElementName(ContainerElementName(' \
               '"campaign")), SpecEndpointTypeNone, SpecDefaultValueNull, SpecKeyAggregation(' \
               'SpecColumnAggregationRuleFunction("Combine")), SpecEquivalenceAggregation(' \
               'SpecColumnAggregationRuleFunction("Combine"))), SpecLatticeSourceTableColumn(' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("MKTO_ActivityRecord_Validation")), ContainerElementName("personName"))), ' \
               'DataTypeNVarChar(510), SpecFieldTypeMetric(FunctionAggregationOperator("Combine")), ' \
               'SpecColumnContentContainerElementName(ContainerElementName("personName")), SpecEndpointTypeNone, ' \
               'SpecDefaultValueNull, SpecKeyAggregation(SpecColumnAggregationRuleFunction("Combine")), ' \
               'SpecEquivalenceAggregation(SpecColumnAggregationRuleFunction("Combine"))), ' \
               'SpecLatticeSourceTableColumn(LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("MKTO_ActivityRecord_Validation")), ' \
               'ContainerElementName("mktPersonId"))), DataTypeLong, SpecFieldTypeAttribute(' \
               'LatticeAddressAtomicIdentifier(ContainerElementName("MKTO_LeadRecord_ID")), ' \
               'SpecConstructiveIsConstructive, FunctionAggregationOperator("Sum")), ' \
               'SpecColumnContentContainerElementName(ContainerElementName("mktPersonId")), SpecEndpointTypeNone, ' \
               'SpecDefaultValueNull, SpecKeyAggregation(SpecColumnAggregationRuleFunction("Sum")), ' \
               'SpecEquivalenceAggregation(SpecColumnAggregationRuleFunction("Sum"))), SpecLatticeSourceTableColumn(' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("MKTO_ActivityRecord_Validation")), ContainerElementName("foreignSysId"))), ' \
               'DataTypeNVarChar(100), SpecFieldTypeMetric(FunctionAggregationOperator("Combine")), ' \
               'SpecColumnContentContainerElementName(ContainerElementName("foreignSysId")), SpecEndpointTypeNone, ' \
               'SpecDefaultValueNull, SpecKeyAggregation(SpecColumnAggregationRuleFunction("Combine")), ' \
               'SpecEquivalenceAggregation(SpecColumnAggregationRuleFunction("Combine"))), ' \
               'SpecLatticeSourceTableColumn(LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("MKTO_ActivityRecord_Validation")), ' \
               'ContainerElementName("orgName"))), DataTypeNVarChar(1022), SpecFieldTypeMetric(' \
               'FunctionAggregationOperator("Combine")), SpecColumnContentContainerElementName(ContainerElementName(' \
               '"orgName")), SpecEndpointTypeNone, SpecDefaultValueNull, SpecKeyAggregation(' \
               'SpecColumnAggregationRuleFunction("Combine")), SpecEquivalenceAggregation(' \
               'SpecColumnAggregationRuleFunction("Combine"))), SpecLatticeSourceTableColumn(' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("MKTO_ActivityRecord_Validation")), ContainerElementName("foreignSysOrgId"))), ' \
               'DataTypeNVarChar(100), SpecFieldTypeMetric(FunctionAggregationOperator("Combine")), ' \
               'SpecColumnContentContainerElementName(ContainerElementName("foreignSysOrgId")), SpecEndpointTypeNone, ' \
               '' \
               'SpecDefaultValueNull, SpecKeyAggregation(SpecColumnAggregationRuleFunction("Combine")), ' \
               'SpecEquivalenceAggregation(SpecColumnAggregationRuleFunction("Combine"))))), SpecKeys(empty), ' \
               'SpecDescription(""), SpecMaximalIsMaximal, SpecKeyAggregation(SpecColumnAggregationRuleMostRecent), ' \
               'SpecEquivalenceAggregation(SpecColumnAggregationRuleMostRecent)), ContainerElementName(' \
               '"MKTO_ActivityRecord_Validation")), SpecLatticeNamedElement(SpecLatticeSourceTable(' \
               'SpecLatticeSourceTableColumnSet((SpecLatticeSourceTableColumn(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(ContainerElementName(' \
               '"MKTO_LeadRecord_Validation")), ContainerElementName("Id"))), DataTypeLong, SpecFieldTypeAttribute(' \
               'LatticeAddressAtomicIdentifier(ContainerElementName("MKTO_LeadRecord_ID")), ' \
               'SpecConstructiveIsConstructive, FunctionAggregationOperator("Sum")), ' \
               'SpecColumnContentContainerElementName(ContainerElementName("Id")), SpecEndpointTypeNone, ' \
               'SpecDefaultValueNull, SpecKeyAggregation(SpecColumnAggregationRuleFunction("Sum")), ' \
               'SpecEquivalenceAggregation(SpecColumnAggregationRuleFunction("Sum"))), SpecLatticeSourceTableColumn(' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("MKTO_LeadRecord_Validation")), ContainerElementName(' \
               '"latticeforleads__Last_Score_Date__c"))), DataTypeDateTime, SpecFieldTypeMetric(' \
               'FunctionAggregationOperator("Max")), SpecColumnContentContainerElementName(ContainerElementName(' \
               '"latticeforleads__Last_Score_Date__c")), SpecEndpointTypeNone, SpecDefaultValueNull, ' \
               'SpecKeyAggregation(SpecColumnAggregationRuleFunction("Max")), SpecEquivalenceAggregation(' \
               'SpecColumnAggregationRuleFunction("Max"))), SpecLatticeSourceTableColumn(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(ContainerElementName(' \
               '"MKTO_LeadRecord_Validation")), ContainerElementName("latticeforleads__Score__c"))), DataTypeInt, ' \
               'SpecFieldTypeMetric(FunctionAggregationOperator("Sum")), SpecColumnContentContainerElementName(' \
               'ContainerElementName("latticeforleads__Score__c")), SpecEndpointTypeNone, SpecDefaultValueNull, ' \
               'SpecKeyAggregation(SpecColumnAggregationRuleFunction("Sum")), SpecEquivalenceAggregation(' \
               'SpecColumnAggregationRuleFunction("Sum"))))), SpecKeys(empty), SpecDescription(""), ' \
               'SpecMaximalIsMaximal, SpecKeyAggregation(SpecColumnAggregationRuleMostRecent), ' \
               'SpecEquivalenceAggregation(SpecColumnAggregationRuleMostRecent)), ContainerElementName(' \
               '"MKTO_LeadRecord_Validation")), SpecLatticeNamedElement(SpecLatticeImportTable(' \
               'SpecSourceAggregationRuleMostRecent(SpecTotalOrderEffectiveDate), SpecColumnBindings((' \
               'SpecColumnBinding(ContainerElementName("id"), DataTypeLong), SpecColumnBinding(ContainerElementName(' \
               '"activityDateTime"), DataTypeDateTime), SpecColumnBinding(ContainerElementName("activityType"), ' \
               'DataTypeNVarChar(510)), SpecColumnBinding(ContainerElementName("mktgAssetName"), DataTypeNVarChar(' \
               '510)), SpecColumnBinding(ContainerElementName("campaign"), DataTypeNVarChar(510)), SpecColumnBinding(' \
               'ContainerElementName("personName"), DataTypeNVarChar(510)), SpecColumnBinding(ContainerElementName(' \
               '"mktPersonId"), DataTypeInt), SpecColumnBinding(ContainerElementName("foreignSysId"), ' \
               'DataTypeNVarChar(100)), SpecColumnBinding(ContainerElementName("orgName"), DataTypeNVarChar(510)), ' \
               'SpecColumnBinding(ContainerElementName("foreignSysOrgId"), DataTypeNVarChar(100)))), ' \
               'SpecSourceFilterNone), ContainerElementName("MKTO_ActivityRecord_Validation_Import")), ' \
               'SpecLatticeNamedElement(SpecLatticeImportTable(SpecSourceAggregationRuleMostRecent(' \
               'SpecTotalOrderEffectiveDate), SpecColumnBindings((SpecColumnBinding(ContainerElementName("Id"), ' \
               'DataTypeInt), SpecColumnBinding(ContainerElementName("latticeforleads__Last_Score_Date__c"), ' \
               'DataTypeDateTime), SpecColumnBinding(ContainerElementName("latticeforleads__Score__c"), ' \
               'DataTypeInt))), SpecSourceFilterNone), ContainerElementName("MKTO_LeadRecord_Validation_Import")), ' \
               'SpecLatticeNamedElement(SpecLatticeExtract(SpecColumnBindings((SpecColumnBinding(' \
               'ContainerElementName("id"), 1000000000000000000000000000006), SpecColumnBinding(ContainerElementName(' \
               '"activityDateTime"), 1000000000000000000000000000011), SpecColumnBinding(ContainerElementName(' \
               '"activityType"), 1000000000000000000000000000016), SpecColumnBinding(ContainerElementName(' \
               '"mktgAssetName"), 1000000000000000000000000000025), SpecColumnBinding(ContainerElementName(' \
               '"campaign"), 1000000000000000000000000000034), SpecColumnBinding(ContainerElementName("personName"), ' \
               '1000000000000000000000000000043), SpecColumnBinding(ContainerElementName("mktPersonId"), ' \
               '1000000000000000000000000000052), SpecColumnBinding(ContainerElementName("foreignSysId"), ' \
               '1000000000000000000000000000057), SpecColumnBinding(ContainerElementName("orgName"), ' \
               '1000000000000000000000000000066), SpecColumnBinding(ContainerElementName("foreignSysOrgId"), ' \
               '1000000000000000000000000000075))), SpecImportDate("2015-11-04 03:50:16"), SpecEffectiveDate(' \
               '"2015-11-04 03:50:16"), SpecExtractDetails((SpecExtractDetail("TableName", ' \
               '"MKTO_ActivityRecord_Validation_Import"), SpecExtractDetail("Rows", "0")))), ContainerElementName(' \
               '"MKTO_ActivityRecord_Validation_Import_Extract_2")), SpecLatticeNamedElement(SpecLatticeExtract(' \
               'SpecColumnBindings((SpecColumnBinding(ContainerElementName("Id"), 1000000000000000000000000000089), ' \
               'SpecColumnBinding(ContainerElementName("latticeforleads__Last_Score_Date__c"), ' \
               '1000000000000000000000000000094), SpecColumnBinding(ContainerElementName(' \
               '"latticeforleads__Score__c"), 1000000000000000000000000000099))), SpecImportDate("2015-11-04 ' \
               '03:50:16"), SpecEffectiveDate("2015-11-04 03:50:16"), SpecExtractDetails((SpecExtractDetail(' \
               '"TableName", "MKTO_LeadRecord_Validation_Import"), SpecExtractDetail("Rows", "0")))), ' \
               'ContainerElementName("MKTO_LeadRecord_Validation_Import_Extract_2")), SpecLatticeNamedElement(' \
               'SpecLatticeBinder(SpecBoundName(ContainerElementName(' \
               '"MKTO_ActivityRecord_Validation_Import_Extract_2"), NameTypeExtract), SpecBoundName(' \
               'ContainerElementName("MKTO_ActivityRecord_Validation_Import"), NameTypeImportTable)), ' \
               'ContainerElementName(' \
               '"Binder_E2I_T_MKTO_ActivityRecord_Validation_Import_Extract_2_MKTO_ActivityRecord_Validation_Import' \
               '")), SpecLatticeNamedElement(SpecLatticeBinder(SpecBoundName(ContainerElementName(' \
               '"MKTO_LeadRecord_Validation_Import_Extract_2"), NameTypeExtract), SpecBoundName(ContainerElementName(' \
               '"MKTO_LeadRecord_Validation_Import"), NameTypeImportTable)), ContainerElementName(' \
               '"Binder_E2I_T_MKTO_LeadRecord_Validation_Import_Extract_2_MKTO_LeadRecord_Validation_Import")), ' \
               'SpecLatticeNamedElement(SpecLatticeBinder(SpecBoundName(ContainerElementName(' \
               '"MKTO_ActivityRecord_Validation_Import"), NameTypeImportTable), SpecBoundName(ContainerElementName(' \
               '"MKTO_ActivityRecord_Validation"), NameTypeSourceTable)), ContainerElementName(' \
               '"Binder_I2S_T_MKTO_ActivityRecord_Validation_Import_MKTO_ActivityRecord_Validation")), ' \
               'SpecLatticeNamedElement(SpecLatticeBinder(SpecBoundName(ContainerElementName(' \
               '"MKTO_LeadRecord_Validation_Import"), NameTypeImportTable), SpecBoundName(ContainerElementName(' \
               '"MKTO_LeadRecord_Validation"), NameTypeSourceTable)), ContainerElementName(' \
               '"Binder_I2S_T_MKTO_LeadRecord_Validation_Import_MKTO_LeadRecord_Validation")), ' \
               'SpecLatticeNamedElement(SpecLatticeFunction(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(ContainerElementName(' \
               '"MKTO_LeadRecord_Validation")), ContainerElementName("Id"))), DataTypeUnknown, ' \
               'SpecFunctionTypeMetric, SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, SpecDescription(' \
               '"")), ContainerElementName("Diagnostic_Alias_Id")), SpecLatticeNamedElement(SpecLatticeFunction(' \
               'LatticeFunctionExpressionTransform(LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("IF"), ' \
               '' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("Like"), LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(ContainerElementName(' \
               '"MKTO_ActivityRecord")), ContainerElementName("activityType"))), ' \
               'LatticeFunctionExpressionConstantScalar("^(New Lead|Click Link|Visit Webpage|Interesting Moment|Open ' \
               'Email|Email Bounced Soft|Fill Out Form|Unsubscribe Email|Click Email)$", DataTypeVarChar(130))), ' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("MKTO_ActivityRecord")), ContainerElementName("activityDateTime"))), ' \
               'LatticeFunctionExpressionConstantNull(DataTypeDateTime)), LatticeAddressSetPi(' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"MKTO_ActivityRecord")))), FunctionAggregationOperator("Max")), DataTypeUnknown, ' \
               'SpecFunctionTypeMetric, SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, SpecDescription(' \
               '"")), ContainerElementName("Diagnostic_Alias_Max_ModifiedDate")), SpecLatticeNamedElement(' \
               'SpecLatticeFunction(LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("MKTO_LeadRecord_Validation")), ' \
               'ContainerElementName("latticeforleads__Score__c"))), DataTypeUnknown, SpecFunctionTypeMetric, ' \
               'SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, SpecDescription("")), ContainerElementName(' \
               '"Diagnostic_Alias_Score")), SpecLatticeNamedElement(SpecLatticeFunction(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(ContainerElementName(' \
               '"MKTO_LeadRecord_Validation")), ContainerElementName("latticeforleads__Last_Score_Date__c"))), ' \
               'DataTypeUnknown, SpecFunctionTypeMetric, SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, ' \
               'SpecDescription("")), ContainerElementName("Diagnostic_Alias_ScoreDate")), SpecLatticeNamedElement(' \
               'SpecLatticeFunction(LatticeFunctionExpressionTransform(LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("IsNull"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("AND"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("NOT"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("IsNullValue"), LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(ContainerElementName(' \
               '"Timestamp_PushToScoring")), ContainerElementName("MKTO_LeadRecord_ID"))))), ' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("Less"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("IsNull"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_Alias_ScoreDate")), LatticeFunctionExpressionConstantScalar("1900-01-01", ' \
               'DataTypeDateTime)), LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_Validate_ScoringRange")))), LatticeFunctionExpressionConstantScalar("FALSE", ' \
               'DataTypeBit)), LatticeAddressSetPi(LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(' \
               'ContainerElementName("MKTO_LeadRecord_Validation")))), FunctionAggregationOperator("Max")), ' \
               'DataTypeUnknown, SpecFunctionTypeMetric, SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, ' \
               'SpecDescription("")), ContainerElementName("Diagnostic_IsFailedScoringLeads")), ' \
               'SpecLatticeNamedElement(SpecLatticeFunction(LatticeFunctionExpressionTransform(' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("IsNull"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("AND"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("NOT"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("IsNullValue"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_Alias_Id")))), LatticeFunctionExpression(LatticeFunctionOperatorIdentifier(' \
               '"IsNullValue"), LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("Timestamp_DownloadedLeads")), ' \
               'ContainerElementName("MKTO_LeadRecord_ID"))))), LatticeFunctionExpressionConstantScalar("FALSE", ' \
               'DataTypeBit)), LatticeAddressSetPi(LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(' \
               'ContainerElementName("MKTO_LeadRecord_Validation")))), FunctionAggregationOperator("Max")), ' \
               'DataTypeUnknown, SpecFunctionTypeMetric, SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, ' \
               'SpecDescription("")), ContainerElementName("Diagnostic_IsMissingDownloadedLeads")), ' \
               'SpecLatticeNamedElement(SpecLatticeFunction(LatticeFunctionExpressionTransform(' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("IsNull"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("AND"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("Greater"), LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(ContainerElementName(' \
               '"Timestamp_DownloadedLeads")), ContainerElementName("Days_SinceLastScoreAtTimeOfDownload"))), ' \
               'LatticeFunctionExpressionConstant("14000", DataTypeInt)), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("Less"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("IsNull"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_Alias_ScoreDate")), LatticeFunctionExpressionConstantScalar("1900-01-01", ' \
               'DataTypeDateTime)), LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_Validate_ScoringRange")))), LatticeFunctionExpressionConstantScalar("FALSE", ' \
               'DataTypeBit)), LatticeAddressSetPi(LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(' \
               'ContainerElementName("MKTO_LeadRecord_Validation")))), FunctionAggregationOperator("Max")), ' \
               'DataTypeUnknown, SpecFunctionTypeMetric, SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, ' \
               'SpecDescription("")), ContainerElementName("Diagnostic_IsUnscored_New/ModifiedLeads")), ' \
               'SpecLatticeNamedElement(SpecLatticeFunction(LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("AddDay"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_Alias_Max_ModifiedDate")), LatticeFunctionExpression(LatticeFunctionOperatorIdentifier(' \
               '"Multiply"), LatticeFunctionIdentifier(ContainerElementName("Const_DaysOfValidityForScore")), ' \
               'LatticeFunctionExpressionConstant("-1", DataTypeInt))), DataTypeUnknown, SpecFunctionTypeMetric, ' \
               'SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, SpecDescription("")), ContainerElementName(' \
               '"Diagnostic_Validate_ScoringRange")), SpecLatticeNamedElement(SpecLatticeQuery(' \
               'LatticeAddressSetPushforward(LatticeAddressExpressionFromLAS(LatticeAddressSetMeet((' \
               'LatticeAddressSetIdentifier(ContainerElementName("Diagnostic_DownloadedUnscoredLeads"))))), ' \
               'LatticeAddressSetMeet((LatticeAddressSetIdentifier(ContainerElementName(' \
               '"Diagnostic_DownloadedUnscoredLeads")))), LatticeAddressExpressionMeet((' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"MKTO_LeadRecord_ID")))))), SpecQueryNamedFunctions(SpecQueryNamedFunctionExpression(' \
               'ContainerElementName("LeadID"), LatticeFunctionIdentifierAddressAtomic(' \
               'LatticeAddressAtomicIdentifier(ContainerElementName("MKTO_LeadRecord_ID")))) ' \
               'SpecQueryNamedFunctionEntityFunctionBoundary SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"LeadScore"), LatticeFunctionIdentifier(ContainerElementName("Diagnostic_Alias_Score"))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("LastScoreDate"), LatticeFunctionIdentifier(' \
               'ContainerElementName("Diagnostic_Alias_ScoreDate"))) SpecQueryNamedFunctionExpression(' \
               'ContainerElementName("ModifiedDate"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"MKTO_LeadRecord_ActivityDate"))) SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"CreatedDate"), LatticeFunctionIdentifier(ContainerElementName("MKTO_LeadRecord_ActivityDateMin"))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("IsFailedScoringLeads"), ' \
               'LatticeFunctionIdentifier(ContainerElementName("Diagnostic_IsFailedScoringLeads"))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("IsDownloadedButMissScoringLeads"), ' \
               'LatticeFunctionIdentifier(ContainerElementName("Diagnostic_IsUnscored_New/ModifiedLeads"))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("TenantName"), LatticeFunctionIdentifier(' \
               'ContainerElementName("Const_TenantName")))), SpecQueryResultSetAll), ContainerElementName(' \
               '"Q_Diagnostic_DownloadedUnscoredLeads")), SpecLatticeNamedElement(SpecLatticeQuery(' \
               'LatticeAddressSetPushforward(LatticeAddressExpressionFromLAS(LatticeAddressSetMeet(empty)), ' \
               'LatticeAddressSetMeet(empty), LatticeAddressExpressionMeet(empty)), SpecQueryNamedFunctions(' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("Diagnostic_LowerLimitTime"), ' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("AddHour"), LatticeFunctionIdentifier(' \
               'ContainerElementName("MKTO_LeadRecord_ActivityDate")), LatticeFunctionExpressionConstant("-28", ' \
               'DataTypeInt))) SpecQueryNamedFunctionExpression(ContainerElementName("Diagnostic_UpperLimitTime"), ' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("AddHour"), LatticeFunctionIdentifier(' \
               'ContainerElementName("MKTO_LeadRecord_ActivityDate")), LatticeFunctionExpressionConstant("-4", ' \
               'DataTypeInt)))), SpecQueryResultSetAll), ContainerElementName("Q_Diagnostic_ExtractLeadsRange")), ' \
               'SpecLatticeNamedElement(SpecLatticeQuery(LatticeAddressSetPushforward(' \
               'LatticeAddressExpressionFromLAS(LatticeAddressSetMeet((LatticeAddressSetIdentifier(' \
               'ContainerElementName("Diagnostic_Filter_ExtractedLeadRecords"))))), LatticeAddressSetMeet((' \
               'LatticeAddressSetIdentifier(ContainerElementName("Diagnostic_Filter_ExtractedLeadRecords")))), ' \
               'LatticeAddressExpressionMeet((LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(' \
               'ContainerElementName("MKTO_LeadRecord_ID")))))), SpecQueryNamedFunctions(' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("MKTO_LeadRecord_ID"), ' \
               'LatticeFunctionIdentifierAddressAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"MKTO_LeadRecord_ID"))))), SpecQueryResultSetAll), ContainerElementName(' \
               '"Q_Diagnostic_GetLeadRecordID")), SpecLatticeNamedElement(SpecLatticeQuery(' \
               'LatticeAddressSetPushforward(LatticeAddressExpressionFromLAS(LatticeAddressSetMeet((' \
               'LatticeAddressSetIdentifier(ContainerElementName("Diagnostic_MissingDownloadedLeads"))))), ' \
               'LatticeAddressSetMeet((LatticeAddressSetIdentifier(ContainerElementName(' \
               '"Diagnostic_MissingDownloadedLeads")))), LatticeAddressExpressionMeet((' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"MKTO_LeadRecord_ID")))))), SpecQueryNamedFunctions(SpecQueryNamedFunctionExpression(' \
               'ContainerElementName("LeadID"), LatticeFunctionIdentifierAddressAtomic(' \
               'LatticeAddressAtomicIdentifier(ContainerElementName("MKTO_LeadRecord_ID")))) ' \
               'SpecQueryNamedFunctionEntityFunctionBoundary SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"LeadScore"), LatticeFunctionIdentifier(ContainerElementName("Diagnostic_Alias_Score"))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("LastScoreDate"), LatticeFunctionIdentifier(' \
               'ContainerElementName("Diagnostic_Alias_ScoreDate"))) SpecQueryNamedFunctionExpression(' \
               'ContainerElementName("ModifiedDate"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"MKTO_LeadRecord_ActivityDate"))) SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"CreatedDate"), LatticeFunctionIdentifier(ContainerElementName("MKTO_LeadRecord_ActivityDateMin"))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("IsMissingDownloadedLeads"), ' \
               'LatticeFunctionIdentifier(ContainerElementName("Diagnostic_IsMissingDownloadedLeads"))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("TenantName"), LatticeFunctionIdentifier(' \
               'ContainerElementName("Const_TenantName")))), SpecQueryResultSetAll), ContainerElementName(' \
               '"Q_Diagnostic_MissingDownloadedLeads")), SpecLatticeNamedElement(SpecLatticeAliasDeclaration(' \
               'LatticeAddressSetFcn(LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("OR"), ' \
               'LatticeFunctionIdentifier(ContainerElementName("Diagnostic_IsFailedScoringLeads")), ' \
               'LatticeFunctionIdentifier(ContainerElementName("Diagnostic_IsUnscored_New/ModifiedLeads"))), ' \
               'LatticeAddressSetPi(LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(' \
               'ContainerElementName("MKTO_LeadRecord_Validation")))))), ContainerElementName(' \
               '"Diagnostic_DownloadedUnscoredLeads")), SpecLatticeNamedElement(SpecLatticeAliasDeclaration(' \
               'LatticeAddressSetPi(LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(' \
               'ContainerElementName("MKTO_ActivityRecord_Validation"))))), ContainerElementName(' \
               '"Diagnostic_Filter_ExtractedLeadRecords")), SpecLatticeNamedElement(SpecLatticeAliasDeclaration(' \
               'LatticeAddressSetFcn(LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_IsMissingDownloadedLeads")), LatticeAddressSetPi(LatticeAddressExpressionAtomic(' \
               'LatticeAddressAtomicIdentifier(ContainerElementName("MKTO_LeadRecord_Validation")))))), ' \
               'ContainerElementName("Diagnostic_MissingDownloadedLeads"))'
      specs += '))'
      specs = specs.replace('latticeforleads__Score__c', self.getScoreField())
      specs = specs.replace('latticeforleads__Last_Score_Date__c', self.getScoreDateField())

    elif type == 'ELQ':

      specs = 'SpecLatticeNamedElements(('
      specs += tenantNameSpec
      specs += 'SpecLatticeNamedElement(SpecLatticeSourceTable(SpecLatticeSourceTableColumnSet((' \
               'SpecLatticeSourceTableColumn(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("ELQ_Contact_Validation")), ContainerElementName(' \
               '"C_DateCreated"))), DataTypeDateTime, SpecFieldTypeMetric(' \
               'FunctionAggregationOperator("Max")), SpecColumnContentContainerElementName(' \
               'ContainerElementName("C_DateCreated")), SpecEndpointTypeNone, SpecDefaultValueNull, ' \
               'SpecKeyAggregation(SpecColumnAggregationRuleFunction("Max")), ' \
               'SpecEquivalenceAggregation(SpecColumnAggregationRuleFunction("Max"))), ' \
               'SpecLatticeSourceTableColumn(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("ELQ_Contact_Validation")), ContainerElementName(' \
               '"C_DateModified"))), DataTypeDateTime, SpecFieldTypeMetric(' \
               'FunctionAggregationOperator("Max")), SpecColumnContentContainerElementName(' \
               'ContainerElementName("C_DateModified")), SpecEndpointTypeNone, SpecDefaultValueNull, ' \
               'SpecKeyAggregation(SpecColumnAggregationRuleFunction("Max")), ' \
               'SpecEquivalenceAggregation(SpecColumnAggregationRuleFunction("Max"))), ' \
               'SpecLatticeSourceTableColumn(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("ELQ_Contact_Validation")), ContainerElementName(' \
               '"C_Lattice_Predictive_Score1"))), DataTypeDouble, SpecFieldTypeMetric(' \
               'FunctionAggregationOperator("Sum")), SpecColumnContentContainerElementName(' \
               'ContainerElementName("C_Lattice_LeadScore1")), SpecEndpointTypeNone, ' \
               'SpecDefaultValueNull, SpecKeyAggregation(SpecColumnAggregationRuleFunction("Sum")), ' \
               'SpecEquivalenceAggregation(SpecColumnAggregationRuleFunction("Sum"))), ' \
               'SpecLatticeSourceTableColumn(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("ELQ_Contact_Validation")), ContainerElementName(' \
               '"C_Lattice_LastScoreDate1"))), DataTypeDateTime, SpecFieldTypeMetric(' \
               'FunctionAggregationOperator("Max")), SpecColumnContentContainerElementName(' \
               'ContainerElementName("C_Lattice_LastScoreDate1")), SpecEndpointTypeNone, ' \
               'SpecDefaultValueNull, SpecKeyAggregation(SpecColumnAggregationRuleFunction("Max")), ' \
               'SpecEquivalenceAggregation(SpecColumnAggregationRuleFunction("Max"))), ' \
               'SpecLatticeSourceTableColumn(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("ELQ_Contact_Validation")), ContainerElementName("ContactID"))), ' \
               'DataTypeVarChar(50), SpecFieldTypeAttribute(LatticeAddressAtomicIdentifier(' \
               'ContainerElementName("ELQ_Contact_ContactID")), SpecConstructiveIsConstructive, ' \
               'FunctionAggregationOperator("Combine")), SpecColumnContentContainerElementName(' \
               'ContainerElementName("ContactID")), SpecEndpointTypeNone, ' \
               'SpecDefaultValueNullNoRTrim, SpecKeyAggregation(SpecColumnAggregationRuleFunction(' \
               '"Combine")), SpecEquivalenceAggregation(SpecColumnAggregationRuleFunction(' \
               '"Combine"))))), SpecKeys(empty), SpecDescription(""), SpecMaximalIsMaximal, ' \
               'SpecKeyAggregation(SpecColumnAggregationRuleMostRecent), SpecEquivalenceAggregation(' \
               'SpecColumnAggregationRuleMostRecent)), ContainerElementName(' \
               '"ELQ_Contact_Validation")), SpecLatticeNamedElement(SpecLatticeImportTable(' \
               'SpecSourceAggregationRuleMostRecent(SpecTotalOrderEffectiveDate), SpecColumnBindings(' \
               '(SpecColumnBinding(ContainerElementName("C_DateCreated"), DataTypeDateTime), ' \
               'SpecColumnBinding(ContainerElementName("C_DateModified"), DataTypeDateTime), ' \
               'SpecColumnBinding(ContainerElementName("C_Lattice_LastScoreDate1"), ' \
               'DataTypeDateTime), SpecColumnBinding(ContainerElementName(' \
               '"C_Lattice_Predictive_Score1"), DataTypeDouble), SpecColumnBinding(' \
               'ContainerElementName("ContactID"), DataTypeInt))), SpecSourceFilterNone), ' \
               'ContainerElementName("ELQ_Contact_Validation_Import")), SpecLatticeNamedElement(' \
               'SpecLatticeExtract(SpecColumnBindings((SpecColumnBinding(ContainerElementName(' \
               '"C_DateCreated"), 1000000000000000000000000000006), SpecColumnBinding(' \
               'ContainerElementName("C_DateModified"), 1000000000000000000000000000011), ' \
               'SpecColumnBinding(ContainerElementName("C_Lattice_LastScoreDate1"), ' \
               '1000000000000000000000000000016), SpecColumnBinding(ContainerElementName(' \
               '"C_Lattice_Predictive_Score1"), 1000000000000000000000000000021), SpecColumnBinding(' \
               'ContainerElementName("ContactID"), 1000000000000000000000000000026))), ' \
               'SpecImportDate("2015-11-04 03:48:52"), SpecEffectiveDate("2015-11-04 03:48:52"), ' \
               'SpecExtractDetails((SpecExtractDetail("TableName", "ELQ_Contact_Validation_Import"), ' \
               'SpecExtractDetail("Rows", "0")))), ContainerElementName(' \
               '"ELQ_Contact_Validation_Import_Extract_2")), SpecLatticeNamedElement(' \
               'SpecLatticeBinder(SpecBoundName(ContainerElementName(' \
               '"ELQ_Contact_Validation_Import_Extract_2"), NameTypeExtract), SpecBoundName(' \
               'ContainerElementName("ELQ_Contact_Validation_Import"), NameTypeImportTable)), ' \
               'ContainerElementName(' \
               '"Binder_E2I_T_ELQ_Contact_Validation_Import_Extract_2_ELQ_Contact_Validation_Import' \
               '")), SpecLatticeNamedElement(SpecLatticeBinder(SpecBoundName(ContainerElementName(' \
               '"ELQ_Contact_Validation_Import"), NameTypeImportTable), SpecBoundName(' \
               'ContainerElementName("ELQ_Contact_Validation"), NameTypeSourceTable)), ' \
               'ContainerElementName(' \
               '"Binder_I2S_T_ELQ_Contact_Validation_Import_ELQ_Contact_Validation")), ' \
               'SpecLatticeNamedElement(SpecLatticeFunction(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("ELQ_Contact_Validation")), ContainerElementName("ContactID"))), ' \
               'DataTypeUnknown, SpecFunctionTypeMetric, SpecFunctionSourceTypeCalculation, ' \
               'SpecDefaultValueNull, SpecDescription("")), ContainerElementName(' \
               '"Diagnostic_Alias_Id")), SpecLatticeNamedElement(SpecLatticeFunction(' \
               'LatticeFunctionExpressionTransform(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("ELQ_Contact")), ContainerElementName("C_DateModified"))), ' \
               'LatticeAddressSetPi(LatticeAddressExpressionAtomic(LatticeAddressAtomicAll)), ' \
               'FunctionAggregationOperator("Max")), DataTypeUnknown, SpecFunctionTypeMetric, ' \
               'SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, SpecDescription("")), ' \
               'ContainerElementName("Diagnostic_Alias_Max_ModifiedDate")), SpecLatticeNamedElement(' \
               'SpecLatticeFunction(LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("ELQ_Contact_Validation")), ' \
               'ContainerElementName("C_Lattice_Predictive_Score1"))), DataTypeUnknown, ' \
               'SpecFunctionTypeMetric, SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, ' \
               'SpecDescription("")), ContainerElementName("Diagnostic_Alias_Score")), ' \
               'SpecLatticeNamedElement(SpecLatticeFunction(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("ELQ_Contact_Validation")), ContainerElementName(' \
               '"C_Lattice_LastScoreDate1"))), DataTypeUnknown, SpecFunctionTypeMetric, ' \
               'SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, SpecDescription("")), ' \
               'ContainerElementName("Diagnostic_Alias_ScoreDate")), SpecLatticeNamedElement(' \
               'SpecLatticeFunction(LatticeFunctionExpressionTransform(LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("IsNull"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("AND"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("NOT"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("IsNullValue"), LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("Timestamp_PushToScoring")), ContainerElementName(' \
               '"ELQ_Contact_ContactID"))))), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("Less"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("IsNull"), LatticeFunctionIdentifier(' \
               'ContainerElementName("Diagnostic_Alias_ScoreDate")), ' \
               'LatticeFunctionExpressionConstantScalar("1900-01-01", DataTypeDateTime)), ' \
               'LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_Validate_ScoringRange")))), LatticeFunctionExpressionConstantScalar(' \
               '"FALSE", DataTypeBit)), LatticeAddressSetPi(LatticeAddressExpressionAtomic(' \
               'LatticeAddressAtomicIdentifier(ContainerElementName("ELQ_Contact_Validation")))), ' \
               'FunctionAggregationOperator("Max")), DataTypeUnknown, SpecFunctionTypeMetric, ' \
               'SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, SpecDescription("")), ' \
               'ContainerElementName("Diagnostic_IsFailedScoringLeads")), SpecLatticeNamedElement(' \
               'SpecLatticeFunction(LatticeFunctionExpressionTransform(LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("IsNull"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("AND"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("NOT"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("IsNullValue"), LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("ELQ_Contact_Validation")), ContainerElementName(' \
               '"ContactID"))))), LatticeFunctionExpression(LatticeFunctionOperatorIdentifier(' \
               '"IsNullValue"), LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("Timestamp_DownloadedLeads")), ' \
               'ContainerElementName("ELQ_Contact_ContactID"))))), ' \
               'LatticeFunctionExpressionConstantScalar("FALSE", DataTypeBit)), LatticeAddressSetPi(' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"ELQ_Contact_Validation")))), FunctionAggregationOperator("Max")), DataTypeUnknown, ' \
               'SpecFunctionTypeMetric, SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, ' \
               'SpecDescription("")), ContainerElementName("Diagnostic_IsMissingDownloadedLeads")), ' \
               'SpecLatticeNamedElement(SpecLatticeFunction(LatticeFunctionExpressionTransform(' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("IsNull"), ' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("AND"), ' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("Greater"), ' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("Timestamp_DownloadedLeads")), ' \
               'ContainerElementName("Days_SinceLastScoreAtTimeOfDownload"))), ' \
               'LatticeFunctionExpressionConstant("14000", DataTypeInt)), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("Less"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("IsNull"), LatticeFunctionIdentifier(' \
               'ContainerElementName("Diagnostic_Alias_ScoreDate")), ' \
               'LatticeFunctionExpressionConstantScalar("1900-01-01", DataTypeDateTime)), ' \
               'LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_Validate_ScoringRange")))), LatticeFunctionExpressionConstantScalar(' \
               '"FALSE", DataTypeBit)), LatticeAddressSetPi(LatticeAddressExpressionAtomic(' \
               'LatticeAddressAtomicIdentifier(ContainerElementName("ELQ_Contact_Validation")))), ' \
               'FunctionAggregationOperator("Max")), DataTypeUnknown, SpecFunctionTypeMetric, ' \
               'SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, SpecDescription("")), ' \
               'ContainerElementName("Diagnostic_IsUnscored_New/ModifiedLeads")), ' \
               'SpecLatticeNamedElement(SpecLatticeFunction(LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("AddDay"), LatticeFunctionIdentifier(' \
               'ContainerElementName("Diagnostic_Alias_Max_ModifiedDate")), ' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("Multiply"), ' \
               'LatticeFunctionIdentifier(ContainerElementName("Const_DaysOfValidityForScore")), ' \
               'LatticeFunctionExpressionConstant("-1", DataTypeInt))), DataTypeUnknown, ' \
               'SpecFunctionTypeMetric, SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, ' \
               'SpecDescription("")), ContainerElementName("Diagnostic_Validate_ScoringRange")), ' \
               'SpecLatticeNamedElement(SpecLatticeQuery(LatticeAddressSetPushforward(' \
               'LatticeAddressExpressionFromLAS(LatticeAddressSetMeet((LatticeAddressSetIdentifier(' \
               'ContainerElementName("Diagnostic_DownloadedUnscoredLeads"))))), ' \
               'LatticeAddressSetMeet((LatticeAddressSetIdentifier(ContainerElementName(' \
               '"Diagnostic_DownloadedUnscoredLeads")))), LatticeAddressExpressionMeet((' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"ELQ_Contact_ContactID")))))), SpecQueryNamedFunctions(' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("LeadID"), ' \
               'LatticeFunctionIdentifierAddressAtomic(LatticeAddressAtomicIdentifier(' \
               'ContainerElementName("ELQ_Contact_ContactID")))) ' \
               'SpecQueryNamedFunctionEntityFunctionBoundary SpecQueryNamedFunctionExpression(' \
               'ContainerElementName("TenantName"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"Const_TenantName"))) SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"LeadScore"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_Alias_Score"))) SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"LastScoreDate"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_Alias_ScoreDate"))) SpecQueryNamedFunctionExpression(' \
               'ContainerElementName("ModifiedDate"), LatticeFunctionExpressionTransform(' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("ELQ_Contact_Validation")), ' \
               'ContainerElementName("C_DateModified"))), LatticeAddressSetFromFcnSupport(' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("ELQ_Contact_Validation")), ' \
               'ContainerElementName("C_DateModified")))), FunctionAggregationOperator("Max"))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("CreatedDate"), ' \
               'LatticeFunctionExpressionTransform(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("ELQ_Contact_Validation")), ContainerElementName(' \
               '"C_DateCreated"))), LatticeAddressSetFromFcnSupport(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("ELQ_Contact_Validation")), ContainerElementName(' \
               '"C_DateCreated")))), FunctionAggregationOperator("Max"))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("IsFailedScoringLeads"), ' \
               'LatticeFunctionIdentifier(ContainerElementName("Diagnostic_IsFailedScoringLeads"))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"IsDownloadedButMissScoringLeads"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_IsUnscored_New/ModifiedLeads")))), SpecQueryResultSetAll), ' \
               'ContainerElementName("Q_Diagnostic_DownloadedUnscoredLeads")), ' \
               'SpecLatticeNamedElement(SpecLatticeQuery(LatticeAddressSetPushforward(' \
               'LatticeAddressExpressionFromLAS(LatticeAddressSetMeet(empty)), LatticeAddressSetMeet(' \
               'empty), LatticeAddressExpressionMeet(empty)), SpecQueryNamedFunctions(' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("Diagnostic_LowerLimitTime"), ' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("AddHour"), ' \
               'LatticeFunctionIdentifier(ContainerElementName("Diagnostic_Alias_Max_ModifiedDate")), ' \
               'LatticeFunctionExpressionConstant("-28", DataTypeInt))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("Diagnostic_UpperLimitTime"), ' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("AddHour"), ' \
               'LatticeFunctionIdentifier(ContainerElementName("Diagnostic_Alias_Max_ModifiedDate")), ' \
               'LatticeFunctionExpressionConstant("-4", DataTypeInt))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("Diagnostic_RescoreThreshold"), ' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("ConvertToString"), ' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("AddDay"), ' \
               'LatticeFunctionIdentifier(ContainerElementName("Diagnostic_Alias_Max_ModifiedDate")), ' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("Multiply"), ' \
               'LatticeFunctionIdentifier(ContainerElementName("Const_DaysOfValidityForScore")), ' \
               'LatticeFunctionExpressionConstantScalar("-1", DataTypeInt)))))), ' \
               'SpecQueryResultSetAll), ContainerElementName("Q_Diagnostic_ExtractLeadsRange")), ' \
               'SpecLatticeNamedElement(SpecLatticeQuery(LatticeAddressSetPushforward(' \
               'LatticeAddressExpressionFromLAS(LatticeAddressSetMeet((LatticeAddressSetIdentifier(' \
               'ContainerElementName("Diagnostic_MissingDownloadedLeads"))))), LatticeAddressSetMeet(' \
               '(LatticeAddressSetIdentifier(ContainerElementName(' \
               '"Diagnostic_MissingDownloadedLeads")))), LatticeAddressExpressionMeet((' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"ELQ_Contact_ContactID")))))), SpecQueryNamedFunctions(' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("LeadID"), ' \
               'LatticeFunctionIdentifierAddressAtomic(LatticeAddressAtomicIdentifier(' \
               'ContainerElementName("ELQ_Contact_ContactID")))) ' \
               'SpecQueryNamedFunctionEntityFunctionBoundary SpecQueryNamedFunctionExpression(' \
               'ContainerElementName("TenantName"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"Const_TenantName"))) SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"LeadScore"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_Alias_Score"))) SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"LastScoreDate"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_Alias_ScoreDate"))) SpecQueryNamedFunctionExpression(' \
               'ContainerElementName("ModifiedDate"), LatticeFunctionExpressionTransform(' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("ELQ_Contact_Validation")), ' \
               'ContainerElementName("C_DateModified"))), LatticeAddressSetFromFcnSupport(' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("ELQ_Contact_Validation")), ' \
               'ContainerElementName("C_DateModified")))), FunctionAggregationOperator("Max"))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("CreatedDate"), ' \
               'LatticeFunctionExpressionTransform(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("ELQ_Contact_Validation")), ContainerElementName(' \
               '"C_DateCreated"))), LatticeAddressSetFromFcnSupport(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("ELQ_Contact_Validation")), ContainerElementName(' \
               '"C_DateCreated")))), FunctionAggregationOperator("Max"))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("IsMissingDownloadedLeads"), ' \
               'LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_IsMissingDownloadedLeads")))), SpecQueryResultSetAll), ' \
               'ContainerElementName("Q_Diagnostic_MissingDownloadedLeads")), ' \
               'SpecLatticeNamedElement(SpecLatticeAliasDeclaration(LatticeAddressSetFcn(' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("OR"), ' \
               'LatticeFunctionIdentifier(ContainerElementName("Diagnostic_IsFailedScoringLeads")), ' \
               'LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_IsUnscored_New/ModifiedLeads"))), LatticeAddressSetPi(' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"ELQ_Contact_Validation")))))), ContainerElementName(' \
               '"Diagnostic_DownloadedUnscoredLeads")), SpecLatticeNamedElement(' \
               'SpecLatticeAliasDeclaration(LatticeAddressSetFcn(LatticeFunctionIdentifier(' \
               'ContainerElementName("Diagnostic_IsMissingDownloadedLeads")), LatticeAddressSetPi(' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"ELQ_Contact_Validation")))))), ContainerElementName(' \
               '"Diagnostic_MissingDownloadedLeads"))'
      specs += '))'
      specs = specs.replace('C_Lattice_Predictive_Score1', self.getScoreField())
      specs = specs.replace('C_Lattice_LastScoreDate1', self.getScoreDateField())

    else:
      specs = 'SpecLatticeNamedElements(('
      specs += tenantNameSpec
      specs += 'SpecLatticeNamedElement(SpecLatticeSourceTable(SpecLatticeSourceTableColumnSet((' \
               'SpecLatticeSourceTableColumn(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("SFDC_Contact_Validation")), ContainerElementName("Id"))), ' \
               'DataTypeVarChar(50), SpecFieldTypeAttribute(LatticeAddressAtomicIdentifier(' \
               'ContainerElementName("SFDC_Lead_Contact_ID")), SpecConstructiveIsConstructive, ' \
               'FunctionAggregationOperator("Combine")), SpecColumnContentContainerElementName(' \
               'ContainerElementName("Id")), SpecEndpointTypeNone, SpecDefaultValueNullNoRTrim, ' \
               'SpecKeyAggregation(SpecColumnAggregationRuleFunction("Combine")), ' \
               'SpecEquivalenceAggregation(SpecColumnAggregationRuleFunction("Combine"))), ' \
               'SpecLatticeSourceTableColumn(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("SFDC_Contact_Validation")), ContainerElementName(' \
               '"CreatedDate"))), DataTypeDateTime, SpecFieldTypeMetric(FunctionAggregationOperator(' \
               '"Max")), SpecColumnContentContainerElementName(ContainerElementName("CreatedDate")), ' \
               'SpecEndpointTypeNone, SpecDefaultValueNull, SpecKeyAggregation(' \
               'SpecColumnAggregationRuleFunction("Max")), SpecEquivalenceAggregation(' \
               'SpecColumnAggregationRuleFunction("Max"))), SpecLatticeSourceTableColumn(' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("SFDC_Contact_Validation")), ' \
               'ContainerElementName("LastModifiedDate"))), DataTypeDateTime, SpecFieldTypeMetric(' \
               'FunctionAggregationOperator("Max")), SpecColumnContentContainerElementName(' \
               'ContainerElementName("LastModifiedDate")), SpecEndpointTypeNone, ' \
               'SpecDefaultValueNull, SpecKeyAggregation(SpecColumnAggregationRuleFunction("Max")), ' \
               'SpecEquivalenceAggregation(SpecColumnAggregationRuleFunction("Max"))), ' \
               'SpecLatticeSourceTableColumn(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("SFDC_Contact_Validation")), ContainerElementName(' \
               '"latticeforleads__Score__c"))), DataTypeInt, SpecFieldTypeMetric, ' \
               'SpecColumnContentContainerElementName(ContainerElementName("")), ' \
               'SpecEndpointTypeNone, SpecDefaultValue(""), SpecKeyAggregation(' \
               'SpecColumnAggregationRuleDefault), SpecEquivalenceAggregation(' \
               'SpecColumnAggregationRuleDefault)), SpecLatticeSourceTableColumn(' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("SFDC_Contact_Validation")), ' \
               'ContainerElementName("latticeforleads__Last_Score_Date__c"))), DataTypeDateTime, ' \
               'SpecFieldTypeMetric, SpecColumnContentContainerElementName(ContainerElementName("")), ' \
               'SpecEndpointTypeNone, SpecDefaultValue(""), SpecKeyAggregation(' \
               'SpecColumnAggregationRuleDefault), SpecEquivalenceAggregation(' \
               'SpecColumnAggregationRuleDefault)))), SpecKeys(empty), SpecDescription(""), ' \
               'SpecMaximalIsMaximal, SpecKeyAggregation(SpecColumnAggregationRuleMostRecent), ' \
               'SpecEquivalenceAggregation(SpecColumnAggregationRuleMostRecent)), ' \
               'ContainerElementName("SFDC_Contact_Validation")), SpecLatticeNamedElement(' \
               'SpecLatticeSourceTable(SpecLatticeSourceTableColumnSet((SpecLatticeSourceTableColumn(' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("SFDC_Lead_Validation")), ' \
               'ContainerElementName("Id"))), DataTypeVarChar(50), SpecFieldTypeAttribute(' \
               'LatticeAddressAtomicIdentifier(ContainerElementName("SFDC_Lead_Contact_ID")), ' \
               'SpecConstructiveIsConstructive, FunctionAggregationOperator("Combine")), ' \
               'SpecColumnContentContainerElementName(ContainerElementName("Id")), ' \
               'SpecEndpointTypeNone, SpecDefaultValueNullNoRTrim, SpecKeyAggregation(' \
               'SpecColumnAggregationRuleFunction("Combine")), SpecEquivalenceAggregation(' \
               'SpecColumnAggregationRuleFunction("Combine"))), SpecLatticeSourceTableColumn(' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("SFDC_Lead_Validation")), ' \
               'ContainerElementName("CreatedDate"))), DataTypeDateTime, SpecFieldTypeMetric(' \
               'FunctionAggregationOperator("Max")), SpecColumnContentContainerElementName(' \
               'ContainerElementName("CreatedDate")), SpecEndpointTypeNone, SpecDefaultValueNull, ' \
               'SpecKeyAggregation(SpecColumnAggregationRuleFunction("Max")), ' \
               'SpecEquivalenceAggregation(SpecColumnAggregationRuleFunction("Max"))), ' \
               'SpecLatticeSourceTableColumn(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("SFDC_Lead_Validation")), ContainerElementName(' \
               '"LastModifiedDate"))), DataTypeDateTime, SpecFieldTypeMetric(' \
               'FunctionAggregationOperator("Max")), SpecColumnContentContainerElementName(' \
               'ContainerElementName("LastModifiedDate")), SpecEndpointTypeNone, ' \
               'SpecDefaultValueNull, SpecKeyAggregation(SpecColumnAggregationRuleFunction("Max")), ' \
               'SpecEquivalenceAggregation(SpecColumnAggregationRuleFunction("Max"))), ' \
               'SpecLatticeSourceTableColumn(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("SFDC_Lead_Validation")), ContainerElementName(' \
               '"latticeforleads__Score__c"))), DataTypeInt, SpecFieldTypeMetric(' \
               'FunctionAggregationOperator("Sum")), SpecColumnContentContainerElementName(' \
               'ContainerElementName("latticeforleads__Score__c")), SpecEndpointTypeNone, ' \
               'SpecDefaultValueNull, SpecKeyAggregation(SpecColumnAggregationRuleFunction("Sum")), ' \
               'SpecEquivalenceAggregation(SpecColumnAggregationRuleFunction("Sum"))), ' \
               'SpecLatticeSourceTableColumn(LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("SFDC_Lead_Validation")), ContainerElementName(' \
               '"latticeforleads__Last_Score_Date__c"))), DataTypeDateTime, SpecFieldTypeMetric(' \
               'FunctionAggregationOperator("Max")), SpecColumnContentContainerElementName(' \
               'ContainerElementName("latticeforleads__Last_Score_Date__c")), SpecEndpointTypeNone, ' \
               'SpecDefaultValueNull, SpecKeyAggregation(SpecColumnAggregationRuleFunction("Max")), ' \
               'SpecEquivalenceAggregation(SpecColumnAggregationRuleFunction("Max"))))), ' \
               'SpecKeys(empty), SpecDescription(""), SpecMaximalIsMaximal, SpecKeyAggregation(' \
               'SpecColumnAggregationRuleMostRecent), SpecEquivalenceAggregation(' \
               'SpecColumnAggregationRuleMostRecent)), ContainerElementName("SFDC_Lead_Validation")), ' \
               'SpecLatticeNamedElement(SpecLatticeImportTable(SpecSourceAggregationRuleMostRecent(' \
               'SpecTotalOrderEffectiveDate), SpecColumnBindings((SpecColumnBinding(' \
               'ContainerElementName("CreatedDate"), DataTypeDateTime), SpecColumnBinding(' \
               'ContainerElementName("Id"), DataTypeNVarChar(36)), SpecColumnBinding(' \
               'ContainerElementName("LastModifiedDate"), DataTypeDateTime), SpecColumnBinding(' \
               'ContainerElementName("latticeforleads__Last_Score_Date__c"), DataTypeDateTime), ' \
               'SpecColumnBinding(ContainerElementName("latticeforleads__Score__c"), DataTypeInt))), ' \
               'SpecSourceFilterNone), ContainerElementName("SFDC_Contact_Validation_Import")), ' \
               'SpecLatticeNamedElement(SpecLatticeImportTable(SpecSourceAggregationRuleMostRecent(' \
               'SpecTotalOrderEffectiveDate), SpecColumnBindings((SpecColumnBinding(' \
               'ContainerElementName("CreatedDate"), DataTypeDateTime), SpecColumnBinding(' \
               'ContainerElementName("Id"), DataTypeNVarChar(36)), SpecColumnBinding(' \
               'ContainerElementName("LastModifiedDate"), DataTypeDateTime), SpecColumnBinding(' \
               'ContainerElementName("latticeforleads__Last_Score_Date__c"), DataTypeDateTime), ' \
               'SpecColumnBinding(ContainerElementName("latticeforleads__Score__c"), DataTypeInt))), ' \
               'SpecSourceFilterNone), ContainerElementName("SFDC_Lead_Validation_Import")), ' \
               'SpecLatticeNamedElement(SpecLatticeExtract(SpecColumnBindings((SpecColumnBinding(' \
               'ContainerElementName("CreatedDate"), 1000000000000000000000000000006), ' \
               'SpecColumnBinding(ContainerElementName("Id"), 1000000000000000000000000000011), ' \
               'SpecColumnBinding(ContainerElementName("LastModifiedDate"), ' \
               '1000000000000000000000000000020), SpecColumnBinding(ContainerElementName(' \
               '"latticeforleads__Last_Score_Date__c"), 1000000000000000000000000000025), ' \
               'SpecColumnBinding(ContainerElementName("latticeforleads__Score__c"), ' \
               '1000000000000000000000000000030))), SpecImportDate("2015-11-04 03:51:31"), ' \
               'SpecEffectiveDate("2015-11-04 03:51:31"), SpecExtractDetails((SpecExtractDetail(' \
               '"TableName", "SFDC_Contact_Validation_Import"), SpecExtractDetail("Rows", "0")))), ' \
               'ContainerElementName("SFDC_Contact_Validation_Import_Extract_2")), ' \
               'SpecLatticeNamedElement(SpecLatticeExtract(SpecColumnBindings((SpecColumnBinding(' \
               'ContainerElementName("CreatedDate"), 1000000000000000000000000000040), ' \
               'SpecColumnBinding(ContainerElementName("Id"), 1000000000000000000000000000045), ' \
               'SpecColumnBinding(ContainerElementName("LastModifiedDate"), ' \
               '1000000000000000000000000000054), SpecColumnBinding(ContainerElementName(' \
               '"latticeforleads__Last_Score_Date__c"), 1000000000000000000000000000059), ' \
               'SpecColumnBinding(ContainerElementName("latticeforleads__Score__c"), ' \
               '1000000000000000000000000000064))), SpecImportDate("2015-11-04 03:51:31"), ' \
               'SpecEffectiveDate("2015-11-04 03:51:31"), SpecExtractDetails((SpecExtractDetail(' \
               '"TableName", "SFDC_Lead_Validation_Import"), SpecExtractDetail("Rows", "0")))), ' \
               'ContainerElementName("SFDC_Lead_Validation_Import_Extract_2")), ' \
               'SpecLatticeNamedElement(SpecLatticeBinder(SpecBoundName(ContainerElementName(' \
               '"SFDC_Contact_Validation_Import_Extract_2"), NameTypeExtract), SpecBoundName(' \
               'ContainerElementName("SFDC_Contact_Validation_Import"), NameTypeImportTable)), ' \
               'ContainerElementName(' \
               '"Binder_E2I_T_SFDC_Contact_Validation_Import_Extract_2_SFDC_Contact_Validation_Import' \
               '")), SpecLatticeNamedElement(SpecLatticeBinder(SpecBoundName(ContainerElementName(' \
               '"SFDC_Lead_Validation_Import_Extract_2"), NameTypeExtract), SpecBoundName(' \
               'ContainerElementName("SFDC_Lead_Validation_Import"), NameTypeImportTable)), ' \
               'ContainerElementName(' \
               '"Binder_E2I_T_SFDC_Lead_Validation_Import_Extract_2_SFDC_Lead_Validation_Import")), ' \
               'SpecLatticeNamedElement(SpecLatticeBinder(SpecBoundName(ContainerElementName(' \
               '"SFDC_Contact_Validation_Import"), NameTypeImportTable), SpecBoundName(' \
               'ContainerElementName("SFDC_Contact_Validation"), NameTypeSourceTable)), ' \
               'ContainerElementName(' \
               '"Binder_I2S_T_SFDC_Contact_Validation_Import_SFDC_Contact_Validation")), ' \
               'SpecLatticeNamedElement(SpecLatticeBinder(SpecBoundName(ContainerElementName(' \
               '"SFDC_Lead_Validation_Import"), NameTypeImportTable), SpecBoundName(' \
               'ContainerElementName("SFDC_Lead_Validation"), NameTypeSourceTable)), ' \
               'ContainerElementName(' \
               '"Binder_I2S_T_SFDC_Lead_Validation_Import_SFDC_Lead_Validation")), ' \
               'SpecLatticeNamedElement(SpecLatticeFunction(LatticeFunctionExpressionTransform(' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("IsNull"), ' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("SFDC_Contact_Validation")), ' \
               'ContainerElementName("Id"))), LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("SFDC_Lead_Validation")), ContainerElementName("Id")))), ' \
               'LatticeAddressSetPi(LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(' \
               'ContainerElementName("SFDC_Lead_Contact_ID")))), FunctionAggregationOperator(' \
               '"None")), DataTypeUnknown, SpecFunctionTypeMetric, SpecFunctionSourceTypeCalculation, ' \
               'SpecDefaultValueNull, SpecDescription("")), ContainerElementName(' \
               '"Diagnostic_Alias_Id")), SpecLatticeNamedElement(SpecLatticeFunction(' \
               'LatticeFunctionExpressionTransform(LatticeFunctionIdentifier(ContainerElementName(' \
               '"SFDC_LastModifiedDate")), LatticeAddressSetPi(LatticeAddressExpressionAtomic(' \
               'LatticeAddressAtomicAll)), FunctionAggregationOperator("Max")), DataTypeUnknown, ' \
               'SpecFunctionTypeMetric, SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, ' \
               'SpecDescription("")), ContainerElementName("Diagnostic_Alias_Max_ModifiedDate")), ' \
               'SpecLatticeNamedElement(SpecLatticeFunction(LatticeFunctionExpressionTransform(' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("IsNull"), ' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("SFDC_Contact_Validation")), ' \
               'ContainerElementName("latticeforleads__Score__c"))), LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("SFDC_Lead_Validation")), ContainerElementName(' \
               '"latticeforleads__Score__c")))), LatticeAddressSetPi(LatticeAddressExpressionAtomic(' \
               'LatticeAddressAtomicIdentifier(ContainerElementName("SFDC_Lead_Contact_ID")))), ' \
               'FunctionAggregationOperator("None")), DataTypeUnknown, SpecFunctionTypeMetric, ' \
               'SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, SpecDescription("")), ' \
               'ContainerElementName("Diagnostic_Alias_Score")), SpecLatticeNamedElement(' \
               'SpecLatticeFunction(LatticeFunctionExpressionTransform(LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("IsNull"), LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("SFDC_Contact_Validation")), ContainerElementName(' \
               '"latticeforleads__Last_Score_Date__c"))), LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("SFDC_Lead_Validation")), ContainerElementName(' \
               '"latticeforleads__Last_Score_Date__c")))), LatticeAddressSetPi(' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"SFDC_Lead_Contact_ID")))), FunctionAggregationOperator("None")), DataTypeUnknown, ' \
               'SpecFunctionTypeMetric, SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, ' \
               'SpecDescription("")), ContainerElementName("Diagnostic_Alias_ScoreDate")), ' \
               'SpecLatticeNamedElement(SpecLatticeFunction(LatticeFunctionExpressionTransform(' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("IsNull"), ' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("AND"), ' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("NOT"), ' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("IsNullValue"), ' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("Timestamp_PushToScoring")), ' \
               'ContainerElementName("SFDC_Lead_Contact_ID"))))), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("Less"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("IsNull"), LatticeFunctionIdentifier(' \
               'ContainerElementName("Diagnostic_Alias_ScoreDate")), ' \
               'LatticeFunctionExpressionConstantScalar("1900-01-01", DataTypeDateTime)), ' \
               'LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_Validate_ScoringRange")))), LatticeFunctionExpressionConstantScalar(' \
               '"FALSE", DataTypeBit)), LatticeAddressSetPi(LatticeAddressExpressionAtomic(' \
               'LatticeAddressAtomicIdentifier(ContainerElementName("SFDC_Lead_Contact_ID")))), ' \
               'FunctionAggregationOperator("Max")), DataTypeUnknown, SpecFunctionTypeMetric, ' \
               'SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, SpecDescription("")), ' \
               'ContainerElementName("Diagnostic_IsFailedScoringLeads")), SpecLatticeNamedElement(' \
               'SpecLatticeFunction(LatticeFunctionExpressionTransform(LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("IsNull"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("AND"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("NOT"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("IsNullValue"), LatticeFunctionIdentifier(' \
               'ContainerElementName("Diagnostic_Alias_Id")))), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("IsNullValue"), LatticeFunctionIdentifier(' \
               'ContainerElementNameTableQualifiedName(LatticeSourceTableIdentifier(' \
               'ContainerElementName("Timestamp_Downloaded_Lead_Contact")), ContainerElementName(' \
               '"SFDC_Lead_Contact_ID"))))), LatticeFunctionExpressionConstantScalar("FALSE", ' \
               'DataTypeBit)), LatticeAddressSetPi(LatticeAddressExpressionAtomic(' \
               'LatticeAddressAtomicIdentifier(ContainerElementName("SFDC_Lead_Contact_ID")))), ' \
               'FunctionAggregationOperator("Max")), DataTypeUnknown, SpecFunctionTypeMetric, ' \
               'SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, SpecDescription("")), ' \
               'ContainerElementName("Diagnostic_IsMissingDownloadedLeads")), ' \
               'SpecLatticeNamedElement(SpecLatticeFunction(LatticeFunctionExpressionTransform(' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("IsNull"), ' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("AND"), ' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("Greater"), ' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName(' \
               '"Timestamp_Downloaded_Lead_Contact")), ContainerElementName(' \
               '"Days_SinceLastScoreAtTimeOfDownload"))), LatticeFunctionExpressionConstant("14000", ' \
               'DataTypeInt)), LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("Less"), ' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("IsNull"), ' \
               'LatticeFunctionIdentifier(ContainerElementName("Diagnostic_Alias_ScoreDate")), ' \
               'LatticeFunctionExpressionConstantScalar("1900-01-01", DataTypeDateTime)), ' \
               'LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_Validate_ScoringRange")))), LatticeFunctionExpressionConstantScalar(' \
               '"FALSE", DataTypeBit)), LatticeAddressSetPi(LatticeAddressExpressionAtomic(' \
               'LatticeAddressAtomicIdentifier(ContainerElementName("SFDC_Lead_Contact_ID")))), ' \
               'FunctionAggregationOperator("Max")), DataTypeUnknown, SpecFunctionTypeMetric, ' \
               'SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, SpecDescription("")), ' \
               'ContainerElementName("Diagnostic_IsUnscored_New/ModifiedLeads")), ' \
               'SpecLatticeNamedElement(SpecLatticeFunction(LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("AddDay"), LatticeFunctionIdentifier(' \
               'ContainerElementName("Diagnostic_Alias_Max_ModifiedDate")), ' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("Multiply"), ' \
               'LatticeFunctionIdentifier(ContainerElementName("Const_DaysOfValidityForScore")), ' \
               'LatticeFunctionExpressionConstant("-1", DataTypeInt))), DataTypeUnknown, ' \
               'SpecFunctionTypeMetric, SpecFunctionSourceTypeCalculation, SpecDefaultValueNull, ' \
               'SpecDescription("")), ContainerElementName("Diagnostic_Validate_ScoringRange")), ' \
               'SpecLatticeNamedElement(SpecLatticeQuery(LatticeAddressSetPushforward(' \
               'LatticeAddressExpressionFromLAS(LatticeAddressSetMeet((LatticeAddressSetFcn(' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("OR"), ' \
               'LatticeFunctionIdentifier(ContainerElementName("Diagnostic_IsFailedScoringLeads")), ' \
               'LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_IsUnscored_New/ModifiedLeads"))), LatticeAddressSetPi(' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"SFDC_Lead_Contact_ID")))))))), LatticeAddressSetMeet((LatticeAddressSetFcn(' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("OR"), ' \
               'LatticeFunctionIdentifier(ContainerElementName("Diagnostic_IsFailedScoringLeads")), ' \
               'LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_IsUnscored_New/ModifiedLeads"))), LatticeAddressSetPi(' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"SFDC_Lead_Contact_ID"))))))), LatticeAddressExpressionMeet((' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"SFDC_Lead_Contact_ID")))))), SpecQueryNamedFunctions(' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("LeadID"), ' \
               'LatticeFunctionIdentifierAddressAtomic(LatticeAddressAtomicIdentifier(' \
               'ContainerElementName("SFDC_Lead_Contact_ID")))) ' \
               'SpecQueryNamedFunctionEntityFunctionBoundary SpecQueryNamedFunctionExpression(' \
               'ContainerElementName("TenantName"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"Const_TenantName"))) SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"LeadScore"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_Alias_Score"))) SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"LastScoreDate"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_Alias_ScoreDate"))) SpecQueryNamedFunctionExpression(' \
               'ContainerElementName("ModifiedDate"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"SFDC_LastModifiedDate"))) SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"CreatedDate"), LatticeFunctionIdentifier(ContainerElementName("SFDC_CreatedDate"))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("IsFailedScoringLeads"), ' \
               'LatticeFunctionIdentifier(ContainerElementName("Diagnostic_IsFailedScoringLeads"))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"IsDownloadedButMissScoringLeads"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_IsUnscored_New/ModifiedLeads")))), SpecQueryResultSetAll), ' \
               'ContainerElementName("Q_Diagnostic_DownloadedUnscoredLeads")), ' \
               'SpecLatticeNamedElement(SpecLatticeQuery(LatticeAddressSetPushforward(' \
               'LatticeAddressExpressionFromLAS(LatticeAddressSetMeet(empty)), LatticeAddressSetMeet(' \
               'empty), LatticeAddressExpressionMeet(empty)), SpecQueryNamedFunctions(' \
               'SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"Diagnostic_LowerLimitTime_Contact"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("AddHour"), LatticeFunctionExpressionTransform(' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("SFDC_Contact")), ' \
               'ContainerElementName("LastModifiedDate"))), LatticeAddressSetPi(' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"SFDC_Contact")))), FunctionAggregationOperator("Max")), ' \
               'LatticeFunctionExpressionConstant("-28", DataTypeInt))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"Diagnostic_UpperLimitTime_Contact"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("AddHour"), LatticeFunctionExpressionTransform(' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("SFDC_Contact")), ' \
               'ContainerElementName("LastModifiedDate"))), LatticeAddressSetPi(' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"SFDC_Contact")))), FunctionAggregationOperator("Max")), ' \
               'LatticeFunctionExpressionConstant("-4", DataTypeInt))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"Diagnostic_RescoreThreshold_Contact"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("AddDay"), LatticeFunctionExpressionTransform(' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("SFDC_Contact")), ' \
               'ContainerElementName("LastModifiedDate"))), LatticeAddressSetPi(' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"SFDC_Contact")))), FunctionAggregationOperator("Max")), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("Multiply"), LatticeFunctionIdentifier(' \
               'ContainerElementName("Const_DaysOfValidityForScore")), ' \
               'LatticeFunctionExpressionConstantScalar("-1", DataTypeInt)))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"Diagnostic_LowerLimitTime_Lead"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("AddHour"), LatticeFunctionExpressionTransform(' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("SFDC_Lead")), ' \
               'ContainerElementName("LastModifiedDate"))), LatticeAddressSetPi(' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"SFDC_Lead")))), FunctionAggregationOperator("Max")), ' \
               'LatticeFunctionExpressionConstant("-28", DataTypeInt))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"Diagnostic_UpperLimitTime_Lead"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("AddHour"), LatticeFunctionExpressionTransform(' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("SFDC_Lead")), ' \
               'ContainerElementName("LastModifiedDate"))), LatticeAddressSetPi(' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"SFDC_Lead")))), FunctionAggregationOperator("Max")), ' \
               'LatticeFunctionExpressionConstant("-4", DataTypeInt))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"Diagnostic_RescoreThreshold_Lead"), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("AddDay"), LatticeFunctionExpressionTransform(' \
               'LatticeFunctionIdentifier(ContainerElementNameTableQualifiedName(' \
               'LatticeSourceTableIdentifier(ContainerElementName("SFDC_Lead")), ' \
               'ContainerElementName("LastModifiedDate"))), LatticeAddressSetPi(' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"SFDC_Lead")))), FunctionAggregationOperator("Max")), LatticeFunctionExpression(' \
               'LatticeFunctionOperatorIdentifier("Multiply"), LatticeFunctionIdentifier(' \
               'ContainerElementName("Const_DaysOfValidityForScore")), ' \
               'LatticeFunctionExpressionConstantScalar("-1", DataTypeInt))))), ' \
               'SpecQueryResultSetAll), ContainerElementName("Q_Diagnostic_ExtractLeadsRange")), ' \
               'SpecLatticeNamedElement(SpecLatticeQuery(LatticeAddressSetPushforward(' \
               'LatticeAddressExpressionFromLAS(LatticeAddressSetMeet((LatticeAddressSetFcn(' \
               'LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_IsMissingDownloadedLeads")), LatticeAddressSetPi(' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"SFDC_Lead_Contact_ID")))))))), LatticeAddressSetMeet((LatticeAddressSetFcn(' \
               'LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_IsMissingDownloadedLeads")), LatticeAddressSetPi(' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"SFDC_Lead_Contact_ID"))))))), LatticeAddressExpressionMeet((' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"SFDC_Lead_Contact_ID")))))), SpecQueryNamedFunctions(' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("LeadID"), ' \
               'LatticeFunctionIdentifierAddressAtomic(LatticeAddressAtomicIdentifier(' \
               'ContainerElementName("SFDC_Lead_Contact_ID")))) ' \
               'SpecQueryNamedFunctionEntityFunctionBoundary SpecQueryNamedFunctionExpression(' \
               'ContainerElementName("TenantName"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"Const_TenantName"))) SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"LeadScore"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_Alias_Score"))) SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"LastScoreDate"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_Alias_ScoreDate"))) SpecQueryNamedFunctionExpression(' \
               'ContainerElementName("ModifiedDate"), LatticeFunctionIdentifier(ContainerElementName(' \
               '"SFDC_LastModifiedDate"))) SpecQueryNamedFunctionExpression(ContainerElementName(' \
               '"CreatedDate"), LatticeFunctionIdentifier(ContainerElementName("SFDC_CreatedDate"))) ' \
               'SpecQueryNamedFunctionExpression(ContainerElementName("IsMissingDownloadedLeads"), ' \
               'LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_IsMissingDownloadedLeads")))), SpecQueryResultSetAll), ' \
               'ContainerElementName("Q_Diagnostic_MissingDownloadedLeads")), ' \
               'SpecLatticeNamedElement(SpecLatticeAliasDeclaration(LatticeAddressSetFcn(' \
               'LatticeFunctionExpression(LatticeFunctionOperatorIdentifier("OR"), ' \
               'LatticeFunctionIdentifier(ContainerElementName("Diagnostic_IsFailedScoringLeads")), ' \
               'LatticeFunctionIdentifier(ContainerElementName(' \
               '"Diagnostic_IsUnscored_New/ModifiedLeads"))), LatticeAddressSetPi(' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"SFDC_Lead_Contact_ID")))))), ContainerElementName(' \
               '"Diagnostic_DownloadedUnscoredLeads")), SpecLatticeNamedElement(' \
               'SpecLatticeAliasDeclaration(LatticeAddressSetFcn(LatticeFunctionIdentifier(' \
               'ContainerElementName("Diagnostic_IsMissingDownloadedLeads")), LatticeAddressSetPi(' \
               'LatticeAddressExpressionAtomic(LatticeAddressAtomicIdentifier(ContainerElementName(' \
               '"SFDC_Lead_Contact_ID")))))), ContainerElementName(' \
               '"Diagnostic_MissingDownloadedLeads"))'
      specs += '))'

      specs = specs.replace('latticeforleads__Score__c', self.getScoreField())
      specs = specs.replace('latticeforleads__Last_Score_Date__c', self.getScoreDateField())

    conn_mgr.setSpec('Diagnostic_VisiDB_Specs', specs)

    return True
